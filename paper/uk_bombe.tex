

\chapter{Turing-Welchman Bombe}

In the previous chapters, we have seen complicated manual
cryptographic techniques give rise to a set of electromechanical
tools meant to make such work tractable over short time periods.
Changes to the Enigma protocol would soon necessitate the
construction of one of the largest such electromechanical devices to
date, known as the {\bf{Bombe}}.

\subsection{Changes to the Enigma Protocol}
Recall that during the use of the Polish Bomba, operators were
instructed to send their window setting (\emph{Grundstellung}) in
plaintext, and then use this to doubly encode their message key
(\emph{Spruchschl端ssel}). Starting in 1940, a small but impactful
change was made to the Enigma encryption protocol for the Army and
Air Force -- operators were instructed to send their encoded message
key only once.
\\\\The Polish Bomba relied on relationships between the doubly
encoded message key to function, without such relationships all the
previously mentioned tools became useless. World War II had begun and
the need for intelligence material was greater than ever. Thus,
British intelligence brought a group of crypt-analysts,
mathematicians, historians, linguists, and more, to Bletchley Park to
engage in a large-scale attempt to break the Enigma machine with this
new protocol.
\\\\No name is more well known from this operation than that of Alan
Turing, whose work went on to become the foundations of modern
computer science. Turing needed to find a new means of attacking the
Enigma encryption that could no longer rely on the doubly enciphered
message key. Consider that the reliance on the doubly enciphered
message key was really just a reliance on the knowledge that two
letters encoded the same plaintext at specific intervals of distance.
Thus, Turing began engineering a method of deducing daily keys via a
known plaintext attack.

% As discussed in CITE the \emph{Grundstellung} rotor
% position was sent along with the daily key and an operator chose a
% \emph{Spruchschlusse} to
% encode twice at the start of a message. Later iterations of this
% protocol removed the \emph{Grundstellung}
% from key sheets.
% \\\\These new key sheets contained the following columns
% columns \emph{Tag/Datum}, \emph{Walzenlage}, \emph{Ringstellung},
% \emph{Steckerverbindungen}, and \emph{Kenngruppen}
% \\\\Notice the removal of the \emph{Grundstellung} as well as the
% addition of the \emph{Kenngruppen}. The \emph{Kenngruppen} were a set of
% four trigrams used to identify which setting was being used to encode
% a message, this is particularly useful if trying to decode a message
% using a prior day's key.
% The operator would choose a trigram from the the \emph{Kenngruppen},
% append two letters to the front of the trigram,
% and this five letter combination (known as the
% \emph{Buchstabenkenngruppe}) would preceed the message being sent.
% If a message
% was sent in multiple segments, multiple \emph{Buchstabenkenngruppe}
% were used to start each segment.
% \\\\When sending a message the operator was to use the following protocol
% \begin{enumerate}[I.]
%   \item The time at which the message was sent is listed
%   \item The number of parts which the message contained is listed
%   \item Which message part is being sent is listed
%   \item The length of the message part (not including
%         \emph{Buchstabenkenngruppe}) is listed
%   \item A \emph{Grundstellung} rotor position is chosen and listed
%   \item A \emph{Spruchschl端ssel} rotor position is chosen and encoded
%         using the \emph{Grundstellung}, this is listed
%   \item The \emph{Buchstabenkenngruppe} is listed
%   \item The message part encoded using the daily key and the
%         \emph{Spruchschl端ssel} position is listed
% \end{enumerate}
% It is clear that with this protocol, the Polish Bomba could no longer
% deduce the necessary
% details to decrypt Enigma messages. All of the permutation
% information contained in the original key distribution
% protocol was removed and a new method needed to be derived for
% infering information about the daily key.
% \section{Loops}
% The removal of the double encoded \emph{Spruchschl端ssel} does not
% mean that permutation information cannot be stored elsewhere in the message.
% For the sake of argument, let us say we knew that our encrypted
% message had plaintext encoding

% \begin{center}
% \begin{tikzpicture}[node distance=1cm, every node/.style={draw,
% circle, minimum height=0.1cm, minimum width=0.1cm}]

%     % Centering the diagram
%     \node (a1) [] {D};
%     \node (a2) [right=0.1cm of a1] {Y};
%     \node (a3) [right=0.1cm of a2] {Y};
%     \node (a4) [right=0.1cm of a3] {Y};
%     \node (a5) [right=0.1cm of a4] {Y};
%     \node (a6) [right=0.1cm of a5] {Y};
%     \node (a7) [right=0.1cm of a6] {X };
%     \node (a8) [right=0.1cm of a7] {Y};
%     \node (a9) [right=0.1cm of a8] {Y};
%     \node (a10) [right=0.1cm of a9] {Y};
%     \node (a11) [right=0.1cm of a10] {X};

%     % Nodes for ciphertext
%     \node (x1) [below=1cm of a1] {A};
%     \node (x2) [below=1cm of a2] {B};
%     \node (x3) [below=1cm of a3] {R};
%     \node (x4) [below=1cm of a4] {A};
%     \node (x5) [below=1cm of a5] {C};
%     \node (x6) [below=1cm of a6] {A};
%     \node (x7) [below=1cm of a7] {D};
%     \node (x8) [below=1cm of a8] {A};
%     \node (x9) [below=1cm of a9] {B};
%     \node (x10) [below=1cm of a10] {R};
%     \node (x11) [below=1cm of a11] {A};

%     % Arrows for mapping
%     \draw[->] (a1) -- (x1) node[midway, left, draw=none, fill=none] {1};
%     \draw[->] (a2) -- (x2) node[midway, left, draw=none, fill=none] {2};
%     \draw[->] (a3) -- (x3) node[midway, left, draw=none, fill=none] {3};
%     \draw[->] (a4) -- (x4) node[midway, left, draw=none, fill=none] {4};
%     \draw[->] (a5) -- (x5) node[midway, left, draw=none, fill=none] {5};
%     \draw[->] (a6) -- (x6) node[midway, left, draw=none, fill=none] {6};
%     \draw[->] (a7) -- (x7) node[midway, left, draw=none, fill=none] {7};
%     \draw[->] (a8) -- (x8) node[midway, left, draw=none, fill=none] {8};
%     \draw[->] (a9) -- (x9) node[midway, left, draw=none, fill=none] {9};
%     \draw[->] (a10) -- (x10) node[midway, left, draw=none, fill=none] {10};
%     \draw[->] (a11) -- (x11) node[midway, left, draw=none, fill=none] {11};

%     \end{tikzpicture}
% \end{center}

% Where the top row is the ciphertext and the bottom is the
% plaintext, further, the number in each mapping indicates how many
% steps away we are from the rotor
% positions when we began encoding the message.

% \begin{center}
%     \begin{tikzpicture}[node distance=1cm, every node/.style={draw,
% circle, minimum height=0.1cm, minimum width=0.1cm}]
%         \node (A) at (90:1.5) {$A$};
%         \node (D) at (210:1.5) {$D$};
%         \node (X) at (330:1.5) {$X$};

%         \draw[->, bend right=45] (A) to node[midway, draw=none,
% above] {1} (D);
%         \draw[->, bend right=45] (D) to node[midway, draw=none,
% above] {7} (X);
%         \draw[->, bend right=45] (X) to node[midway, draw=none,
% above] {11} (A);
%       \end{tikzpicture}
% \end{center}

% Recall
% \begin{align*}
%     E_1 &=
% P^{-1}\theta_1R_1^{-1}\theta_1^{-1}R_2^{-1}R_3^{-1}MR_3R_2\theta_1^{-1}R_1\theta_1P
%     \\E_7 &=
% P^{-1}\theta_7R_1^{-1}\theta_7^{-1}R_2^{-1}R_3^{-1}MR_3R_2\theta_7^{-1}R_1\theta_7P
%     \\E_{11} &=
% P^{-1}\theta_{11}R_1^{-1}\theta_{11}^{-1}R_2^{-1}R_3^{-1}MR_3R_2\theta_{11}^{-1}R_1\theta_{11}P
% \end{align*}
% Then it follows that our loop can be represented by
% \begin{align*}
%     \sigma &= E_{11}\circ E_7 \circ E_{1}
% \end{align*}
% and we see that all the intermediate plugboard settings cancel out.
% Lets isolate the plugboard settings by letting
% $\overline{\sigma}$ represent $\sigma$ without the use of the
% plugboard for input and output, then
% \[
%     \sigma = P^{-1}\overline{\sigma}P
% \]
% We have that
% \begin{align*}
%     \sigma(A) &= A
%     \\\iff (P^{-1}\overline{\sigma}P)(A) &= A
%     \\\iff \overline{\sigma}(P(A)) &= P(A)
% \end{align*}

% Suppose that our initial rotor position was correct, then certainly
% our $\overline{\sigma}$ is correct. We can make a hypothesis
% that $A$ is steckered to $K$ in the plugboard. Suppose we find that
% $\overline{\sigma}(K) \ne K$, then $\sigma(A)\ne A$ and our loop is
% broken, breaking our assumptions, thus $A$ must not be steckered to $K$.
% But this will actually elimiate more hypotheses than just $A$ being
% steckered to $K$. We know that $\overline{\sigma}(K)$ is some
% letter which is not $K$. So we continue with a new hypothesis that
% $A$ is steckered to
% $\overline{\sigma}(K)$ and if we find
% $\overline{\sigma}(\overline{\sigma}(K)) \ne \overline{\sigma}(K)$,
% then we have further eliminated this possibility.
% Each new hypothesis suggests that $A$ is steckered to
% $\overline{\sigma}^{i}(K)$ which will be shown to be false if
% $\overline{\sigma}^{i+1}(K) \ne \overline{\sigma}^{i}(K)$. What if
% we find that
% $\overline{\sigma}^{i+1}(K) = \overline{\sigma}^i(K)$ at some
% point? This cannot happen since
% \begin{center}
%         \begin{align*}
%             &\overline{\sigma}^{i+1}(K) = \overline{\sigma}^i(K)
%             \\\Rightarrow \text{
% }&\overline{\sigma}^{-i}\circ\overline{\sigma}^{i+1}(K) =
% \overline\sigma^{-i}\circ\overline{\sigma}^i(K)
%             \\\Rightarrow \text{ }&\overline{\sigma}(K) = K
%         \end{align*}
% \end{center}
% which by supposition is false. Then we can continue in our
% hypotheses until we eventually reach a cycle where $\overline\sigma^i(K) = K$.
% Then we gather a set of impossible steckerings, that is
% \begin{align*}
%     P(A) \notin \{\text{ }\overline{\sigma}^i(K)\text{ }\vert\text{
% }i\in\mathbb{N}\}
% \end{align*}
% \\\\The notation we are using can be simplified significantly. The
% set $\{\text{ }\overline{\sigma}^i(K)\text{ }\vert\text{
% }i\in\mathbb{N}\}$ is equivalent to the orbit of $K$ via the group
% action of the
% cyclic subgroup $\langle\overline{\sigma}\rangle$ which can be
% denoted $\langle\overline{\sigma}\rangle\cdot K$.
% \\\\We then have several cases
% \begin{enumerate}
%     \item If $|\langle\overline{\sigma}\rangle\cdot K| = 26$, then
% $A$ cannot be steckered to anything which is clearly
%     impossible, thus our rotor position must be incorrect.
%     \item If $|\langle\overline{\sigma}\rangle\cdot K| = 25$, then
% $A$ can only be steckered to the remaining letter \\$\{A,\dots,Z\} -
%     \langle \overline{\sigma} \rangle\cdot K$
%     \item If $|\langle\overline{\sigma}\rangle\cdot K| = 1$, in
% this case we must have intially had $\overline{\sigma}(K) = K$ so we have not
%     eliminated any possibilities.
% \end{enumerate}

% https://archive.org/details/enigmabattleforc0000seba/page/82/mode/2up?q=herivel
% %
\subsection{Herivel Tip}
While Turing was developing his plaintext attack that ultimately
culminated in the creation of the Bombe, there was a period of time
that some have called a "blackout" in which little to no Enigma
messages could be deciphered. During this time, Bletchley Park
cryptanalyst John Herivel had a simple idea. When operators set their
ring settings as described by the key sheet they would place their
wheels in the machine in the order described, and they would then
turn the outer ring on each wheel so that the corresponding ring
setting letter was at the top of the wheel. If the operator was
particularly lazy, this was \emph{all} they did, or if they were only
slightly lazy, they may turn the wheels a couple turns forward or
back. Regardless, this meant that many operators began enciphering
their messages with a window setting that was nearly identical to the
ring setting. Thus, by looking at several operators first messages of
the day, we would see several cluster around a particular setting
that is likely to be the ring setting. Such an insight became known
as the {\bf{Herevil tip}}.
\\\\With the Herevil tip, we could determine a likely ring setting.
Then by either brute force or use of the clock method, we could
determine the rotor order. Then finally, as we did to recover the
plugboard from the Bomba in section~\ref{bomba_plugboard}, we could
even recover the plugboard settings. Thus, purely by virtue of
operator error, we could recover the entire daily key.
\\\\Ultimatley this only helped them to decipher messages within a
particular network of operators known as the "Red network". However,
as we will later see, access to a set of plaintext from messages will
become a vital component of our plaintext attack.

\section{Plaintext Attack}

Suppose we knew the plaintext which had been enciphered into a
particular Enigma transmission.
Consider the following mapping,
\begin{center}
	\begin{tikzpicture}[node distance=1cm, every node/.style={draw,
					circle, minimum height=0.1cm, minimum width=0.1cm}]

		% Centering the diagram
		\node (a1) [] {\texttt{D}};
		\node (a2) [right=0.1cm of a1] {\texttt{Y}};
		\node (a3) [right=0.1cm of a2] {\texttt{Y}};
		\node (a4) [right=0.1cm of a3] {\texttt{Y}};
		\node (a5) [right=0.1cm of a4] {\texttt{Y}};
		\node (a6) [right=0.1cm of a5] {\texttt{Y}};
		\node (a7) [right=0.1cm of a6] {\texttt{X }};
		\node (a8) [right=0.1cm of a7] {\texttt{Y}};
		\node (a9) [right=0.1cm of a8] {\texttt{Y}};
		\node (a10) [right=0.1cm of a9] {\texttt{Y}};
		\node (a11) [right=0.1cm of a10] {\texttt{X}};

		% Nodes for ciphertext
		\node (x1) [below=1cm of a1] {\texttt{A}};
		\node (x2) [below=1cm of a2] {\texttt{B}};
		\node (x3) [below=1cm of a3] {\texttt{R}};
		\node (x4) [below=1cm of a4] {\texttt{A}};
		\node (x5) [below=1cm of a5] {\texttt{C}};
		\node (x6) [below=1cm of a6] {\texttt{A}};
		\node (x7) [below=1cm of a7] {\texttt{D}};
		\node (x8) [below=1cm of a8] {\texttt{A}};
		\node (x9) [below=1cm of a9] {\texttt{B}};
		\node (x10) [below=1cm of a10] {\texttt{R}};
		\node (x11) [below=1cm of a11] {\texttt{A}};

		% Arrows for mapping
		\draw[->] (a1) -- (x1) node[midway, left, draw=none, fill=none] {1};
		\draw[->] (a2) -- (x2) node[midway, left, draw=none, fill=none] {2};
		\draw[->] (a3) -- (x3) node[midway, left, draw=none, fill=none] {3};
		\draw[->] (a4) -- (x4) node[midway, left, draw=none, fill=none] {4};
		\draw[->] (a5) -- (x5) node[midway, left, draw=none, fill=none] {5};
		\draw[->] (a6) -- (x6) node[midway, left, draw=none, fill=none] {6};
		\draw[->] (a7) -- (x7) node[midway, left, draw=none, fill=none] {7};
		\draw[->] (a8) -- (x8) node[midway, left, draw=none, fill=none] {8};
		\draw[->] (a9) -- (x9) node[midway, left, draw=none, fill=none] {9};
		\draw[->] (a10) -- (x10) node[midway, left, draw=none, fill=none] {10};
		\draw[->] (a11) -- (x11) node[midway, left, draw=none, fill=none] {11};

	\end{tikzpicture}
\end{center}
where the top row indicates our enciphered message, the bottom row
indicates the plain-text,
and the indices on the arrows indicate how many steps forward our
Enigma machine has moved while enciphering this message.
\\\\From this pairing we have that
\begin{center}
	$\sigma_1(\texttt{A}) = {\texttt{D}}$\\
	$\sigma_7(\texttt{D}) = {\texttt{X}}$\\
	$\sigma_{11}(\texttt{X}) = {\texttt{A}}$\\
\end{center}
% Our goal is to determine which Enigma settings were used to encipher
% the message.  In order to achieve this,
% we will examine which settings maintain the relationships between the
% enciphered and plaintext letters.
% \\\\For example, any setting which maintains the above pairing must
% encipher $\texttt{A}$ to $\texttt{D}$ from the first position of
% the machine, then at
% the seventh position, it must encipher $\texttt{D}$ to
% $\texttt{X}$, and at the
% eleventh position $\texttt{X}$ must be enciphered back to
% $\texttt{A}$. It follows that if we had
% three Enigma machines connected in series, with an offset of 1, 7,
% and 11, from our initial position, then inputting $\texttt{A}$ on the first
% machine would result in an ouput of $\texttt{A}$ on the
% third machine.
Thus, $\sigma_1$, $\sigma_7$, and $\sigma_{11}$ form a loop starting
at \texttt{A}. We visualize this loop as follows
\begin{center}
	\begin{tikzpicture}[node distance=1cm, every node/.style={draw,
					circle, minimum height=0.1cm, minimum width=0.1cm}]
		\node (A) at (90:1.5) {$\texttt{A}$};
		\node (D) at (210:1.5) {$\texttt{D}$};
		\node (X) at (330:1.5) {$\texttt{X}$};

		\draw[<->, bend right=45] (A) to node[midway, draw=none, above] {1} (D);
		\draw[<->, bend right=45] (D) to node[midway, draw=none, above] {7} (X);
		\draw[<->, bend right=45] (X) to node[midway, draw=none, above] {11} (A);
	\end{tikzpicture}
\end{center}
Recall that, ignoring turnover, each $\sigma_i$ is of the form
\begin{center}
	$\sigma_i = S^{-1}P^{-(x+i)}N^{-1}P^{x+i}M^{-1}L^{-1}RLMP^{-(x+i)}NP^{x+i}S$
\end{center}
We will denote $\sigma_i$ separated from its plugboard as
\begin{center}
	$\overline{\sigma_i} =
		P^{-(x+i)}N^{-1}P^{x+i}M^{-1}L^{-1}RLMP^{-(x+i)}NP^{x+i}$
\end{center}
\noindent that is $\sigma_i = S^{-1}\overline{\sigma_i}S$
(conversely, $\overline\sigma_i = S^{-1}\sigma_iS$)\footnote{It
	should be noted that $S$ = $S^{-1}$ since the plugboard is always an
	involution}.
Then our loop is expressed by the fact that
$\sigma_{11}\sigma_7\sigma_1$ has a fixed point at $\texttt{A}$.
We also note that the intermediate plugboard settings cancel out, that is
\begin{center}
	\begin{align*}
		\sigma_{1}\sigma_7\sigma_{11} & =
		S^{-1}\overline{\sigma_{1}}SS^{-1}\overline{\sigma_7}SS^{-1}\overline{\sigma_{11}}S
		\\&= S^{-1}
		\overline{\sigma_{1}}\overline{\sigma_7}\overline{\sigma_{11}}
		S
	\end{align*}
\end{center}
We will condense this notation by defining
\begin{center}
	$\pi \coloneq \sigma_{1}\sigma_7\sigma_{11}$
\end{center}
and
\begin{center}
	$\overline{\pi} \coloneq
		\overline{\sigma_{1}}\overline{\sigma_7}\overline{\sigma_{11}}$
\end{center}
And thus we have shown $\pi = S^{-1}\overline{\pi}S$ (conversely,
$\overline\pi = S^{-1}\pi S$).
\\\\Let us hypothesize that $\texttt{A}$ is steckered in the plugboard to
$\alpha$ -- that is, $S(\texttt{A}) = \alpha$ (conversely, $S(\alpha)
	= \texttt{A}$).
It then follows that for a fixed $i\in\mathbb{N}$
\begin{center}
	\begin{align*}
		\overline{\pi}^i(\alpha) & = S\pi^i S(\alpha)
		\\&= S \pi^i(\texttt{A})
		\\&= S(\texttt{A})
	\end{align*}
\end{center}
and so we derive
\begin{center}
	$S(\texttt{A}) = \alpha \Rightarrow S(\texttt{A}) =
		\overline{\pi}^i(\alpha)\text{
		}\forall\text{ }i\in\mathbb{N}$
\end{center}
Then we have that $\texttt{A}$ must be steckered to all values in the set
$\{\overline{\pi}^i(\alpha)\text{ }\vert\text{ }i\in\mathbb{N}\}$.
We note that this set is that orbit of the element $\alpha$ under the
group action of the subgroup $\langle\overline{\pi}\rangle$ -- that is,
$\langle\overline{\pi}\rangle\cdot\alpha$.
\\\\By construction of the Enigma machine, $\texttt{A}$ cannot be steckered to
more than one value at a time, so if
$|\langle\overline{\pi}\rangle\cdot\alpha| > 1$ our initial
hypotheses that $S(\texttt{A}) = \alpha$ must have been incorrect. Further,
the above argument also illustrates that $\texttt{A}$ cannot be steckered to
any element in the orbit of $\alpha$ since
we would similarly find that the orbit of \emph{that} element was not a
singleton. Then we now have
\begin{center}
	$|\langle\overline{\pi}\rangle\cdot\alpha| > 1 \Rightarrow
		\texttt{A} \text{ cannot be steckered to any element in
		}\langle\overline{\pi}\rangle\cdot\alpha$
\end{center}
thus eliminating several elements that $\texttt{A}$ could be steckered to.
\\\\By representing $\overline\pi$ in its cycle notation we can
quickly see whether certain hypotheses are possible. For example,
suppose we found that
\begin{center}
	$\overline\pi =
		(\texttt{ABCDEF})(\texttt{GHIJK})(\texttt{L})(\texttt{MNOPQRSTUVWXYZ})$
\end{center}
If we suppose that $\texttt{A}$ is steckered to any element in the cycle
$(ABCDEF)$ we find that this
element has an orbit of length $6$ in $\langle\overline\pi\rangle$
and thus $\texttt{A}$ cannot be steckered
to any element in this cycle. Then it is clear that $\texttt{A}$ can only be
steckered to $\texttt{L}$ in this case.

\subsection{Scanning Methods}
Turing describes various methods of mechanizing the above analysis of
cycle-type to determine when we can eliminate rotor positions.
\begin{enumerate}
	\item If we examine a particular hypothesis, say $\texttt{A}$ is steckered
	      to $\texttt{A}$, we can rule out this steckering if we find that
	      $\texttt{A}$ is
	      not in a $1$-cycle, that is if $\overline\pi(\texttt{K}) \ne
		      \texttt{K}$. If we
	      mechanize this process we can eliminate rotor positions which do
	      not satisfy this singular hypothesis. Turing called this method
	      \textbf{single line scanning}. Note, however, that this method
	      may eliminate rotor
	      positions which do have valid steckerings, just not the
	      particular steckering that we hypothesized.
	\item If we perform single line scanning in sequence, that is, for
	      each steckering hypothesis, we can rule out rotor positions which
	      have all steckering hypotheses invalid. Turing called this method
	      \textbf{serial scanning}.
	\item Serial scanning requires a separate examination of each
	      steckering. Turing proposed a machine which could concurrently
	      examine all steckering possibilities and eliminate rotor positions
	      which had no valid steckerings. Turing called this method
	      \textbf{simultaneous scanning}.
	\item If we find $\overline\pi$ has a $26$-cycle, then we must
	      have that there are no $1$-cycles and thus no valid steckerings.
	      It then follows that the rotor position is incorrect.
	      If we mechanism this process we can eliminate \emph{some} rotor
	      positions which do not have valid steckerings. We will call this
	      method \textbf{spider scanning}. Note, however, that this method
	      would not, for example, detect that $\overline\pi$ with cycle
	      type $2^{13}$ contains no
	      valid steckerings. As Turing explained,
	      \say{The ideal machine that Welchman was aiming at was to reject
		      any position in which a certain fixed-for-the-time Stecker
		      hypothesis led to any direct contradiction... The spider does
		      more than this in one way and
		      less in another. It is not restricted to dealing with one Stecker
		      hypothesis at a time, and it does not find all direct
		      contradictions.} Effectively, spider-scanning is like a form of
	      simultaneous scanning which is restricted
	      to examining only one cycle at a time.
\end{enumerate}
Iterations of each scanning methods were proposed or designed, but in
the end we find that the spider scanning method was used in the
implementation of the Bombe. At a high level, we encode the structure
of the plaintext-ciphertext pairings, we input a hypothesis that a particular
letter (e.g $\texttt{A}$) is steckered to another (e.g. $\alpha$), and we
electrically produce the elements that must also be steckered to our test letter
(e.g. $\langle\overline{\pi}\rangle\cdot\alpha$) if our hypothesis
were to be true. If we find that this production generates a set of
all letters and thus disqualifies this rotor position from producing
the plaintext we observed, then we can continue on to the next rotor
position until we have no contradictory results from our hypothesis.

\section{The Bombe}

In the section, we outline the construction of a rudimentary Bombe.
Our goal is to construct a machine using the above insight to quickly
eliminate a rotor position based on contradictory hypotheses. We must
shift from the above mathematical construction to an
electromechanical one. %We imagine the Enigma machine as black-box
% that takes in cables encoding, via current, each of the 4 letters, and outputs
% currents on the corresponding letter after applying the Enigma permutation.
Imagine the following set of wires encoding a possible Enigma
permutation we will denoted $\overline\pi_i$ (the bar
indicates we are not yet considering the plugboard).

\tikzset{big box/.style={draw, minimum width=5cm, minimum height=4cm},
	small box/.style={draw, minimum width=1cm, minimum height=1cm}}

\begin{center}
	\begin{tikzpicture}[thick]
		% Draw the box
		\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

		\node at (3, -2) {$\overline\pi_i$};

		% Draw the wires entering the box
		\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{\texttt{a}}};
		\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
		\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
		\draw[-] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

		% Draw the wires exiting the box with crossed mappings
		\draw[-] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
		\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
		\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
		\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

		% Draw the lines inside the box to represent the mapping
		\draw[-] (2, 2) -- (4,-1);
		\draw[-] (2, 1) -- (4, 0);
		\draw[-] (2, 0) -- (4, 1);
		\draw[-] (2,-1) -- (4, 2);

	\end{tikzpicture}
\end{center}
A couple quick notes about this abstraction. First as these lines are
simply wires, current can flow in either direction, left-to-right, or
right-to-left.
Second, we can apply current to multiple wires concurrently, for
example, applying current at $\texttt{a}$ and $\texttt{c}$ will cause
$\texttt{d}$ and $\texttt{b}$ to be
live on the other side of the machine.
Finally, the choice to use lower case letters will become clear
further in this section as we want to separate the plugboard letters
from the actual plaintext-ciphertext letters.
\\\\As described in our motivating example, we may want to connect
Engima permutations in series to capture an underlying relationship
between a plaintext-ciphertext pairing.
Suppose we had plaintext-ciphertext pairing
\begin{center}
	\begin{tikzpicture}[node distance=1cm, every node/.style={draw,
					circle, minimum height=0.1cm, minimum width=0.1cm}]

		% Centering the diagram
		\node (a1) [] {\texttt{B}};
		\node (a2) [right=0.1cm of a1] {\texttt{C}};
		\node (a3) [right=0.1cm of a2] {\texttt{A}};

		% Nodes for ciphertext
		\node (x1) [below=1cm of a1] {\texttt{A}};
		\node (x2) [below=1cm of a2] {\texttt{B}};
		\node (x3) [below=1cm of a3] {\texttt{C}};

		% Arrows for mapping
		\draw[->] (a1) -- (x1) node[midway, left, draw=none, fill=none] {1};
		\draw[->] (a2) -- (x2) node[midway, left, draw=none, fill=none] {2};
		\draw[->] (a3) -- (x3) node[midway, left, draw=none, fill=none] {3};

	\end{tikzpicture}
\end{center}

\noindent Then we find that there exists a loop in the pairing as follows

\begin{center}
	\begin{tikzpicture}[node distance=1cm, every node/.style={draw,
					circle, minimum height=0.1cm, minimum width=0.1cm}]
		\node (A) at (90:1.5) {\texttt{A}};
		\node (B) at (210:1.5) {\texttt{B}};
		\node (C) at (330:1.5) {\texttt{C}};

		\draw[<->, bend right=45] (A) to node[midway, draw=none, above] {1} (B);
		\draw[<->, bend right=45] (B) to node[midway, draw=none, above] {2} (C);
		\draw[<->, bend right=45] (C) to node[midway, draw=none, above] {3} (A);
	\end{tikzpicture}
\end{center}
We can then think of this loop as a series of three Enigma
permutations. We assume the message began with window setting
\texttt{ZZZ}. We will hypothesize some rotor ordering and we will
further assume a ring setting of \texttt{ZZZ}. Thus the first machine
will be set to a window setting \texttt{ZZZ}, the second set to
\texttt{ZZA}, and the third set to \texttt{ZZB}. Note that this is
assuming no turnover occurred during our enciphering of the plaintext
-- a caveat we will later address. We can connect these Enigma
machines as follows
\begin{center}
	\begin{tikzpicture}[thick, scale=0.6, every node/.style={scale=0.7}]
		% Draw the box
		\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

		\node at (3, -2) {$\overline\pi_3$};

		% Draw the wires entering the box
		\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
		\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
		\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
		\draw[-] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

		% Draw the wires exiting the box with crossed mappings
		\draw[-] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
		\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
		\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
		\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

		% Draw the lines inside the box to represent the mapping
		\draw[-] (2, 2) -- (4,-1);
		\draw[-] (2, 1) -- (4, 0);
		\draw[-] (2, 0) -- (4, 1);
		\draw[-] (2,-1) -- (4, 2);

		\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
		\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
		\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
		\draw[-] (0-3, -1-7) to[out=180, in=180] (0, -1) node[midway, above] {};

		\draw[-] (6+3, 2-7) to[out=360, in=360] (6, 2) node[midway, above] {};
		\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
		\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
		\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

		\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

		\node at (3-3, -2-7) {$\overline\pi_1$};

		% Draw the wires entering the box
		\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
		\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
		\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
		\draw[-] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

		% Draw the wires exiting the box
		\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
		\draw[-] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
		\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
		\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

		% Draw the lines inside the box to represent the mapping
		\draw[-] (2-3, 2-7) -- (4-3, 0-7);
		\draw[-] (2-3, 1-7) -- (4-3, -1-7);
		\draw[-] (2-3, 0-7) -- (4-3, 2-7);
		\draw[-] (2-3,-1-7) -- (4-3, 1-7);

		\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

		\node at (3+3, -2-7) {$\overline\pi_2$};

		% Draw the wires entering the box
		\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
		\draw[-] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
		\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
		\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

		% Draw the wires exiting the box
		\draw[-] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
		\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
		\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
		\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

		\draw[-] (2+3, 2-7) -- (4+3, 1-7);
		\draw[-] (2+3, 1-7) -- (4+3, 2-7);
		\draw[-] (2+3, 0-7) -- (4+3, -1-7);
		\draw[-] (2+3,-1-7) -- (4+3, 0-7);

		\node[draw,circle] at (-4.5, -1) {\texttt{A}};
		\node[draw,circle] at (3, -9) {\texttt{B}};
		\node[draw,circle] at (10.5, -1) {\texttt{C}};

	\end{tikzpicture}
\end{center}
As before, let us make a hypothesis regarding steckering. Suppose
$S(\texttt{A}) = \texttt{D}$. We know that $\texttt{A}$ must map to
$\texttt{A}$ via
$S^{-1}\overline\pi_3\overline\pi_2\overline\pi_1 S$. In our
diagram, however we do not see a plugboard so how can we represent
the plugboard's involvement? In order
to achieve this \emph{we} will function as the plugboard by applying
voltage to the $\texttt{d}$ line on the $\texttt{A}$ cable thus
implicitly performing the
plugboard mapping in which $S(\texttt{A}) = \texttt{D}$.
Then this will go through the electrical mapping $\overline\pi_1$
arriving on the \texttt{B} cable, followed by $\overline\pi_2$ arriving
on the \texttt{C} cable, followed by $\overline\pi_3$ arriving back on
the \texttt{A} cable, where \emph{we} as the implicit plugboard know that
the output of this electrical mapping must go through the plugboard
again to get a final output of \texttt{A}.
\\\\We will denote each wire by a capital and lowercase letter which
indicates both the cable and specific wire to which we refer. For
instance, line \texttt{d} on cable \texttt{A} will be denoted
$\texttt{Ad}$. Any time a wire
$\texttt{Xy}$ is live, implicitly this means that there is an intermediary
plugboard which mapped $S(\texttt{X}) = \texttt{Y}$ or $S(\texttt{Y})
	= \texttt{X}$.
To see this electrical mapping occur let us visualize a current being
sent through $\texttt{Ad}$.
\begin{figure}[H]
	\begin{minipage}{0.45\textwidth}
		\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
			% Draw the box
			\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

			\node at (3, -2) {$\overline\pi_3$};

			% Draw the wires entering the box
			\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
			\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
			\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
			\draw[-, red] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box with crossed mappings
			\draw[-] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
			\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
			\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
			\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2, 2) -- (4,-1);
			\draw[-] (2, 1) -- (4, 0);
			\draw[-] (2, 0) -- (4, 1);
			\draw[-] (2,-1) -- (4, 2);

			\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
			\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
			\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
			\draw[-, red] (0-3, -1-7) to[out=180, in=180] (0, -1)
			node[midway, above] {};

			\draw[-] (6+3, 2-7) to[out=360, in=360] (6, 2) node[midway, above] {};
			\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
			\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
			\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

			\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

			\node at (3-3, -2-7) {$\overline\pi_1$};

			% Draw the wires entering the box
			\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
			\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-, red] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box
			\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
			\draw[-] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
			\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
			\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2-3, 2-7) -- (4-3, 0-7);
			\draw[-] (2-3, 1-7) -- (4-3, -1-7);
			\draw[-] (2-3, 0-7) -- (4-3, 2-7);
			\draw[-] (2-3,-1-7) -- (4-3, 1-7);

			\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

			\node at (3+3, -2-7) {$\overline\pi_2$};

			% Draw the wires entering the box
			\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
			\draw[-] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
			\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
			\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

			% Draw the wires exiting the box
			\draw[-] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
			\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

			\draw[-] (2+3, 2-7) -- (4+3, 1-7);
			\draw[-] (2+3, 1-7) -- (4+3, 2-7);
			\draw[-] (2+3, 0-7) -- (4+3, -1-7);
			\draw[-] (2+3,-1-7) -- (4+3, 0-7);

			\node[draw,circle] at (-4.5, -1) {\texttt{A}};
			\node[draw,circle] at (3, -9) {\texttt{B}};
			\node[draw,circle] at (10.5, -1) {\texttt{C}};

		\end{tikzpicture}
	\end{minipage}
	\hfill
	\begin{minipage}{0.45\textwidth}
		\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
			% Draw the box
			\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

			\node at (3, -2) {$\overline\pi_3$};

			% Draw the wires entering the box
			\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
			\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
			\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
			\draw[-, red] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box with crossed mappings
			\draw[-] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
			\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
			\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
			\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2, 2) -- (4,-1);
			\draw[-] (2, 1) -- (4, 0);
			\draw[-] (2, 0) -- (4, 1);
			\draw[-] (2,-1) -- (4, 2);

			\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
			\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
			\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
			\draw[-, red] (0-3, -1-7) to[out=180, in=180] (0, -1)
			node[midway, above] {};

			\draw[-] (6+3, 2-7) to[out=360, in=360] (6, 2) node[midway, above] {};
			\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
			\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
			\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

			\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

			\node at (3-3, -2-7) {$\overline\pi_1$};

			% Draw the wires entering the box
			\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
			\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-, red] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box
			\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
			\draw[-, red] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
			\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
			\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2-3, 2-7) -- (4-3, 0-7);
			\draw[-] (2-3, 1-7) -- (4-3, -1-7);
			\draw[-] (2-3, 0-7) -- (4-3, 2-7);
			\draw[-, red] (2-3,-1-7) -- (4-3, 1-7);

			\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

			\node at (3+3, -2-7) {$\overline\pi_2$};

			% Draw the wires entering the box
			\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
			\draw[-, red] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
			\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
			\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

			% Draw the wires exiting the box
			\draw[-] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
			\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

			\draw[-] (2+3, 2-7) -- (4+3, 1-7);
			\draw[-] (2+3, 1-7) -- (4+3, 2-7);
			\draw[-] (2+3, 0-7) -- (4+3, -1-7);
			\draw[-] (2+3,-1-7) -- (4+3, 0-7);

			\node[draw,circle] at (-4.5, -1) {\texttt{A}};
			\node[draw,circle] at (3, -9) {\texttt{B}};
			\node[draw,circle] at (10.5, -1) {\texttt{C}};

		\end{tikzpicture}
	\end{minipage}
	\\\\\\\\
	\noindent
	\begin{minipage}{0.45\textwidth}
		\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
			% Draw the box
			\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

			\node at (3, -2) {$\overline\pi_3$};

			% Draw the wires entering the box
			\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
			\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
			\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
			\draw[-, red] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box with crossed mappings
			\draw[-, red] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
			\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
			\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
			\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2, 2) -- (4,-1);
			\draw[-] (2, 1) -- (4, 0);
			\draw[-] (2, 0) -- (4, 1);
			\draw[-] (2,-1) -- (4, 2);

			\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
			\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
			\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
			\draw[-, red] (0-3, -1-7) to[out=180, in=180] (0, -1)
			node[midway, above] {};

			\draw[- ,red] (6+3, 2-7) to[out=360, in=360] (6, 2)
			node[midway, above] {};
			\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
			\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
			\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

			\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

			\node at (3-3, -2-7) {$\overline\pi_1$};

			% Draw the wires entering the box
			\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
			\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-, red] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box
			\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
			\draw[-, red] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
			\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
			\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2-3, 2-7) -- (4-3, 0-7);
			\draw[-] (2-3, 1-7) -- (4-3, -1-7);
			\draw[-] (2-3, 0-7) -- (4-3, 2-7);
			\draw[-, red] (2-3,-1-7) -- (4-3, 1-7);

			\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

			\node at (3+3, -2-7) {$\overline\pi_2$};

			% Draw the wires entering the box
			\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
			\draw[-, red] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
			\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
			\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

			% Draw the wires exiting the box
			\draw[-, red] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
			\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

			\draw[-] (2+3, 2-7) -- (4+3, 1-7);
			\draw[-, red] (2+3, 1-7) -- (4+3, 2-7);
			\draw[-] (2+3, 0-7) -- (4+3, -1-7);
			\draw[-] (2+3,-1-7) -- (4+3, 0-7);

			\node[draw,circle] at (-4.5, -1) {\texttt{A}};
			\node[draw,circle] at (3, -9) {\texttt{B}};
			\node[draw,circle] at (10.5, -1) {\texttt{C}};

		\end{tikzpicture}
	\end{minipage}
	\hfill
	\begin{minipage}{0.45\textwidth}
		\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
			% Draw the box
			\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

			\node at (3, -2) {$\overline\pi_3$};

			% Draw the wires entering the box
			\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
			\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
			\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
			\draw[-, red] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box with crossed mappings
			\draw[-, red] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
			\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
			\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
			\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2, 2) -- (4,-1);
			\draw[-] (2, 1) -- (4, 0);
			\draw[-] (2, 0) -- (4, 1);
			\draw[-, red] (2,-1) -- (4, 2);

			\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
			\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
			\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
			\draw[-, red] (0-3, -1-7) to[out=180, in=180] (0, -1)
			node[midway, above] {};

			\draw[- ,red] (6+3, 2-7) to[out=360, in=360] (6, 2)
			node[midway, above] {};
			\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
			\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
			\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

			\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

			\node at (3-3, -2-7) {$\overline\pi_1$};

			% Draw the wires entering the box
			\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
			\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-, red] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box
			\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
			\draw[-, red] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
			\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
			\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2-3, 2-7) -- (4-3, 0-7);
			\draw[-] (2-3, 1-7) -- (4-3, -1-7);
			\draw[-] (2-3, 0-7) -- (4-3, 2-7);
			\draw[-, red] (2-3,-1-7) -- (4-3, 1-7);

			\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

			\node at (3+3, -2-7) {$\overline\pi_2$};

			% Draw the wires entering the box
			\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
			\draw[-, red] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
			\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
			\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

			% Draw the wires exiting the box
			\draw[-, red] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
			\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

			\draw[-] (2+3, 2-7) -- (4+3, 1-7);
			\draw[-, red] (2+3, 1-7) -- (4+3, 2-7);
			\draw[-] (2+3, 0-7) -- (4+3, -1-7);
			\draw[-] (2+3,-1-7) -- (4+3, 0-7);

			\node[draw,circle] at (-4.5, -1) {\texttt{A}};
			\node[draw,circle] at (3, -9) {\texttt{B}};
			\node[draw,circle] at (10.5, -1) {\texttt{C}};

		\end{tikzpicture}
	\end{minipage}
	\caption{Current passing from wire \texttt{Ad} back to wire \texttt{Ad}}
	\label{fig:correct_stecker}
\end{figure}
\noindent Following our hypothesis that $S(\texttt{A}) = \texttt{D}$
we find that after sending
current through $\texttt{Ad}$ we arrive after mapping through
$\overline\pi$ back at $\texttt{Ad}$. Since we got an output of
$\texttt{D}$ before the plugboard mapping, and we know that at the
end this will ultimately map back through the plugboard to
$\texttt{A}$ in order preserve our fixed point at $\texttt{A}$, we
get the statement that $S(\texttt{D}) = \texttt{A}$ which is
perfectly consistent with our original hypothesis.
\\\\On the other hand, if we change
$\overline\pi$ and repeat this process which may end up in the
following situation
\begin{figure}[H]
	\begin{minipage}{0.45\textwidth}
		\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
			% Draw the box
			\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

			\node at (3, -2) {$\overline\pi_3$};

			% Draw the wires entering the box
			\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
			\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
			\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
			\draw[-, red] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box with crossed mappings
			\draw[-] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
			\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
			\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
			\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2, 2) -- (4,-1);
			\draw[-] (2, 1) -- (4, 0);
			\draw[-] (2, 0) -- (4, 1);
			\draw[-] (2,-1) -- (4, 2);

			\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
			\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
			\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
			\draw[-, red] (0-3, -1-7) to[out=180, in=180] (0, -1)
			node[midway, above] {};

			\draw[-] (6+3, 2-7) to[out=360, in=360] (6, 2) node[midway, above] {};
			\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
			\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
			\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

			\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

			\node at (3-3, -2-7) {$\overline\pi_1$};

			% Draw the wires entering the box
			\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
			\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-, red] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box
			\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
			\draw[-] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
			\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
			\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2-3, 2-7) -- (4-3, 0-7);
			\draw[-] (2-3, 1-7) -- (4-3, -1-7);
			\draw[-] (2-3, 0-7) -- (4-3, 2-7);
			\draw[-] (2-3,-1-7) -- (4-3, 1-7);

			\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

			\node at (3+3, -2-7) {$\overline\pi_2$};

			% Draw the wires entering the box
			\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
			\draw[-] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
			\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
			\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

			% Draw the wires exiting the box
			\draw[-] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
			\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

			\draw[-] (2+3, 2-7) -- (4+3, 0-7);
			\draw[-] (2+3, 1-7) -- (4+3, -1-7);
			\draw[-] (2+3, 0-7) -- (4+3, 2-7);
			\draw[-] (2+3,-1-7) -- (4+3, 1-7);

			\node[draw,circle] at (-4.5, -1) {\texttt{\texttt{A}}};
			\node[draw,circle] at (3, -9) {\texttt{\texttt{B}}};
			\node[draw,circle] at (10.5, -1) {\texttt{\texttt{C}}};

		\end{tikzpicture}
	\end{minipage}
	\hfill
	\begin{minipage}{0.45\textwidth}
		\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
			% Draw the box
			\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

			\node at (3, -2) {$\overline\pi_3$};

			% Draw the wires entering the box
			\draw[-, red] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
			\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
			\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
			\draw[-, red] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box with crossed mappings
			\draw[-] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
			\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
			\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
			\draw[-, red] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-, red] (2, 2) -- (4,-1);
			\draw[-] (2, 1) -- (4, 0);
			\draw[-] (2, 0) -- (4, 1);
			\draw[-] (2,-1) -- (4, 2);

			\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
			\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
			\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
			\draw[-, red] (0-3, -1-7) to[out=180, in=180] (0, -1)
			node[midway, above] {};

			\draw[-] (6+3, 2-7) to[out=360, in=360] (6, 2) node[midway, above] {};
			\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
			\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
			\draw[-, red] (6+3, -1-7) to[out=360, in=360] (6, -1)
			node[midway, above] {};

			\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

			\node at (3-3, -2-7) {$\overline\pi_1$};

			% Draw the wires entering the box
			\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
			\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-, red] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box
			\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
			\draw[-, red] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
			\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
			\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2-3, 2-7) -- (4-3, 0-7);
			\draw[-] (2-3, 1-7) -- (4-3, -1-7);
			\draw[-] (2-3, 0-7) -- (4-3, 2-7);
			\draw[-, red] (2-3,-1-7) -- (4-3, 1-7);

			\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

			\node at (3+3, -2-7) {$\overline\pi_2$};

			% Draw the wires entering the box
			\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
			\draw[-, red] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
			\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
			\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

			% Draw the wires exiting the box
			\draw[-] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
			\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-, red] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

			\draw[-] (2+3, 2-7) -- (4+3, 0-7);
			\draw[-, red] (2+3, 1-7) -- (4+3, -1-7);
			\draw[-] (2+3, 0-7) -- (4+3, 2-7);
			\draw[-] (2+3,-1-7) -- (4+3, 1-7);

			\node[draw,circle] at (-4.5, -1) {\texttt{\texttt{A}}};
			\node[draw,circle] at (3, -9) {\texttt{\texttt{B}}};
			\node[draw,circle] at (10.5, -1) {\texttt{\texttt{C}}};

		\end{tikzpicture}
	\end{minipage}
	\caption{Current passing from wire \texttt{Ad} ending up at wire \texttt{Aa}}
	\label{fig:incorrect_stecker}
\end{figure}
\noindent In this example, following our steckering hypothesis
$S(\texttt{A}) = \texttt{D}$,
results in \texttt{Aa} becoming live after mapping through $\overline\pi$ and
thus we must have $S(\texttt{A}) = \texttt{A}$ as well in order for
this to ultimately
map back to \texttt{A} and preserve our fixed point at \texttt{A}.
This creates an inconsistency between our hypothesis and deduction
meaning that we can eliminate the steckering possibilities both
steckering possibilities so that $S(\texttt{A}) \notin \{\texttt{A},
	\texttt{D}\}$
\\\\Effectively, this process is a mechanization of
finding the cycle containing a particular letter. In the above
figure~\ref{fig:incorrect_stecker} sending current from \texttt{Ad}
until we arrive back at \texttt{Ad} is
akin to repeatedly applying $\overline\pi$ to \texttt{D}
until we return to \texttt{D}. This can be visualized in our diagram as

\begin{center}
	\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
		% Draw the box
		\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

		\node at (3, -2) {$\overline\pi_3$};

		% Draw the wires entering the box
		\draw[-, red] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
		\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
		\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
		\draw[-, red] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

		% Draw the wires exiting the box with crossed mappings
		\draw[-, red] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
		\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
		\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
		\draw[-, red] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

		% Draw the lines inside the box to represent the mapping
		\draw[-, red] (2, 2) -- (4,-1);
		\draw[-] (2, 1) -- (4, 0);
		\draw[-] (2, 0) -- (4, 1);
		\draw[-, red] (2,-1) -- (4, 2);

		\draw[-, red] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
		\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
		\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
		\draw[-, red] (0-3, -1-7) to[out=180, in=180] (0, -1)
		node[midway, above] {};

		\draw[-, red] (6+3, 2-7) to[out=360, in=360] (6, 2) node[midway, above] {};
		\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
		\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
		\draw[-, red] (6+3, -1-7) to[out=360, in=360] (6, -1)
		node[midway, above] {};

		\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

		\node at (3-3, -2-7) {$\overline\pi_1$};

		% Draw the wires entering the box
		\draw[-, red] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
		\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
		\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
		\draw[-, red] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

		% Draw the wires exiting the box
		\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
		\draw[-, red] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
		\draw[-, red] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
		\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

		% Draw the lines inside the box to represent the mapping
		\draw[-, red] (2-3, 2-7) -- (4-3, 0-7);
		\draw[-] (2-3, 1-7) -- (4-3, -1-7);
		\draw[-] (2-3, 0-7) -- (4-3, 2-7);
		\draw[-, red] (2-3,-1-7) -- (4-3, 1-7);

		\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

		\node at (3+3, -2-7) {$\overline\pi_2$};

		% Draw the wires entering the box
		\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
		\draw[-, red] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
		\draw[-, red] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
		\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

		% Draw the wires exiting the box
		\draw[-, red] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
		\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
		\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
		\draw[-, red] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

		\draw[-] (2+3, 2-7) -- (4+3, 0-7);
		\draw[-, red] (2+3, 1-7) -- (4+3, -1-7);
		\draw[-, red] (2+3, 0-7) -- (4+3, 2-7);
		\draw[-] (2+3,-1-7) -- (4+3, 1-7);

		\node[draw,circle] at (-4.5, -1) {\texttt{A}};
		\node[draw,circle] at (3, -9) {\texttt{B}};
		\node[draw,circle] at (10.5, -1) {\texttt{C}};

	\end{tikzpicture}
\end{center}
Where we find that in $\overline\pi$ we have the cycle $(\texttt{AD})$
since \texttt{Ad} and \texttt{Aa} are the only two live
wires in the \texttt{A} cable after allowing currently to reach a
steady-state. If we had instead applied current to \texttt{Ab} we would find
that \texttt{Ab} and \texttt{Ac} become live and give us the full
permutation $\overline\pi = (\texttt{AD})(\texttt{BC})$. The beauty
of this design
is that it is able to deduce the elements in a cycle of
$\overline\pi$ nearly instantaneously since it only requires the
circuit to reach
a steady-state.
\\\\Equipped with this tool spider-scanning becomes quite trivial.
The goal of spider-scanning is to eliminate a rotor position by
checking if the permutation has a $26$-cycle. In our diagram, with four lines,
this would be analogous to testing a steckering hypothesis (any
hypothesis) and finding that the entire cable becomes live. Then all
elements lie within the same cycle of $\overline\pi$ and thus all
steckering possibilities are immediately eliminated.
\\\\The Bombe is designed to quickly move through all $26^3$ possible
window settings while maintaining the same relative distances between
each Enigma permutation in our loop. At each configuration
it applies current to test our steckering hypothesis and, only when
an arrangement is such that it
cannot be eliminated and further examination is needed, we will cause
the machine to stop.

\subsubsection{Scramblers}
Thus far we have described the Bombe as connecting Enigma machines.
In reality, the Bombe used a set of rotors known as {\bf{drums}}
mimicking the effect of each Enigma rotor. Thus three drums together
produced the effect of an entire Enigma permutation. Such a set of
drums was called a {\bf{Letchworth scrambler}} which effectively
mimicked the function of the Enigma machine but was double-ended
meaning current could be applied in either direction to achieve our
Enigma permutation.

\subsection{Stopping Mechanism}
The Bombe would stop when it detected
any line (say \texttt{Ab}) is no longer live. To do this, we can
place a differential
relay such that it only engages when a current difference is present
between \texttt{Ab} and some constant power supply line. Then, when
current stops
flowing through \texttt{Ab}, the relay will trigger. We can then wire the
stopping mechanism to the contact terminal of the relay such that the
stopping mechanism will only trigger when line \texttt{Ab} is not live (i.e.
the relay is closed).
\\\\We can further extend this to detect when any line on the \texttt{A}
cable is not live by having each line \texttt{Aa}, \texttt{Ab},
\texttt{Ac}, \texttt{Ad} wired in
parallel, each to a separate relay, all comparing against the same
constant supply voltage. If we wire our stopping mechanism to engage
if any relay closes
then our stopping mechanism will engage if any wire ceases to be live.
\\\\This begs the question of where to place this detecting circuit.
If we are in the situation described above, a loop of Enigma
permutations, then this choice does not matter. This is because if a
$26$-cycle is present in
$\overline\pi_3\overline\pi_2\overline\pi_1$, it must also
be present in
$\overline\pi_2\overline\pi_1\overline\pi_3$ and
$\overline\pi_1\overline\pi_2\overline\pi_1$. This is
because all of these permutations are conjugates of one another, for
example we have
\begin{center}
	$\overline\pi_2\overline\pi_1\overline\pi_3 =
		\overline\pi_3^{-1}(\overline\pi_3\overline\pi_2\overline\pi_1)\overline\pi_3$
\end{center}
Since permutations in the same conjugacy class must have the same
cycle type, it follows that no matter where in the loop we place our
detector, if all wires become live on one cable they will become live
on all cables. Thus, we can place our detector anywhere.

\subsection{Multiple Loops}
In our example we provided only a single loop encoded in the
plaintext-ciphertext pairing. In practice, multiple loops could exist
within such a pairing and we can electrically connect all loops
together within a row on the Bombe to produce a single circuit. For
instance we might have a plaintext-ciphertext pairing as follows
\begin{center}
	\begin{tikzpicture}[node distance=1cm, every node/.style={draw,
					circle, minimum height=0.1cm, minimum width=0.1cm}]

		% Centering the diagram
		\node (a1) [] {\texttt{B}};
		\node (a2) [right=0.1cm of a1] {\texttt{C}};
		\node (a3) [right=0.1cm of a2] {\texttt{A}};
		\node (a4) [right=0.1cm of a3] {\texttt{A}};
		\node (a5) [right=0.1cm of a4] {\texttt{C}};
		\node (a6) [right=0.1cm of a5] {\texttt{C}};

		% Nodes for ciphertext
		\node (x1) [below=1cm of a1] {\texttt{A}};
		\node (x2) [below=1cm of a2] {\texttt{B}};
		\node (x3) [below=1cm of a3] {\texttt{C}};
		\node (x4) [below=1cm of a4] {\texttt{B}};
		\node (x5) [below=1cm of a5] {\texttt{B}};
		\node (x6) [below=1cm of a6] {\texttt{A}};

		% Arrows for mapping
		\draw[->] (a1) -- (x1) node[midway, left, draw=none, fill=none] {1};
		\draw[->] (a2) -- (x2) node[midway, left, draw=none, fill=none] {2};
		\draw[->] (a3) -- (x3) node[midway, left, draw=none, fill=none] {3};
		\draw[->] (a4) -- (x4) node[midway, left, draw=none, fill=none] {4};
		\draw[->] (a5) -- (x5) node[midway, left, draw=none, fill=none] {5};
		\draw[->] (a6) -- (x6) node[midway, left, draw=none, fill=none] {6};

	\end{tikzpicture}
\end{center}
Thus encoding the following loops
\begin{center}
	\scalebox{0.8}{
		\begin{tikzpicture}[node distance=1cm, every node/.style={draw,
						circle, minimum height=0.1cm, minimum width=0.1cm}]
			\node (B) at (135:4) {\texttt{B}};
			\node (C) at (45:4) {\texttt{C}};

			\node (A) at (0,0) {\texttt{A}};
			\node (B2) at (225:4) {\texttt{B}};
			\node (C2) at (315:4) {\texttt{C}};

			\draw[<->, bend right=45] (A) to node[midway, draw=none, above] {4} (B2);
			\draw[<->, bend right=70] (B2) to node[midway, draw=none, above] {5} (C2);
			\draw[<->, bend right=45] (C2) to node[midway, draw=none, above] {6} (A);
			\draw[<->, bend left=45] (A) to node[midway, draw=none, above] {1} (B);
			\draw[<->, bend left=70] (B) to node[midway, draw=none, above] {2} (C);
			\draw[<->, bend left=45] (C) to node[midway, draw=none, above] {3} (A);
		\end{tikzpicture}
	}
\end{center}
With our diagram format this could look as follows
\begin{figure}[H]
	\begin{center}
		\scalebox{0.8}{
			\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
				% Draw the box
				\draw[fill=lightgray] (0+5, 0+2) rectangle (2+5,4+2) node[midway] {};
				\node at (0+5+1, 0+2-0.5) {$\overline\pi_3$};

				% Draw the wires exiting the box
				\draw[-] (7, 5.5) -- (8,5.5) node[midway, above] {\texttt{a}};
				\draw[-] (7, 4.5) -- (8,4.5) node[midway, above] {\texttt{b}};
				\draw[-] (7, 3.5) -- (8, 3.5) node[midway, above] {\texttt{c}};
				\draw[-] (7,2.5) -- (8, 2.5) node[midway, above] {\texttt{d}};

				% Draw the wires entering the box
				\draw[-] (4, 5.5) -- (5,5.5) node[midway, above] {};
				\draw[-] (4, 4.5) -- (5,4.5) node[midway, above] {};
				\draw[-] (4, 3.5) -- (5, 3.5) node[midway, above] {};
				\draw[-] (4,2.5) -- (5, 2.5) node[midway, above] {};

				\draw[fill=lightgray] (0-5,0+2) rectangle (2-5,4+2) node[midway] {};
				\node at (0-5+1, 0+2-0.5) {$\overline\pi_1$};

				% Draw the wires entering the box
				\draw[-] (-13+7, 5.5) -- (-13+8,5.5) node[midway, above] {\texttt{a}};
				\draw[-] (-13+7, 4.5) -- (-13+8,4.5) node[midway, above] {\texttt{b}};
				\draw[-] (-13+7, 3.5) -- (-13+8, 3.5) node[midway, above] {\texttt{c}};
				\draw[-] (-13+7,2.5) -- (-13+8, 2.5) node[midway, above] {\texttt{d}};

				% Draw the wires exiting the box
				\draw[-] (-13+7+3, 5.5) -- (-13+8+3,5.5) node[midway, above] {};
				\draw[-] (-13+7+3, 4.5) -- (-13+8+3,4.5) node[midway, above] {};
				\draw[-] (-13+7+3, 3.5) -- (-13+8+3, 3.5) node[midway, above] {};
				\draw[-] (-13+7+3,2.5) -- (-13+8+3, 2.5) node[midway, above] {};

				\draw[fill=lightgray] (0,0+10) rectangle (2,4+10) node[midway] {};
				\node at (0+1, 0+10-0.5) {$\overline\pi_2$};

				% Draw the wires entering the box
				\draw[-] (-1, 3+10.5) -- (0, 3+10.5) node[midway, above] {\texttt{a}};
				\draw[-] (-1, 2+10.5) -- (0, 2+10.5) node[midway, above] {\texttt{b}};
				\draw[-] (-1, 1+10.5) -- (0, 1+10.5) node[midway, above] {\texttt{c}};
				\draw[-] (-1,0+10.5) -- (0,0+10.5) node[midway, above] {\texttt{d}};

				% Draw the wires exiting the box
				\draw[-] (3+-1, 3+10.5) -- (3+0, 3+10.5) node[midway, above]
				{\texttt{a}};
				\draw[-] (3+-1, 2+10.5) -- (3+0, 2+10.5) node[midway, above]
				{\texttt{b}};
				\draw[-] (3+-1, 1+10.5) -- (3+0, 1+10.5) node[midway, above]
				{\texttt{c}};
				\draw[-] (3+-1,0+10.5) -- (3+0,0+10.5) node[midway, above] {\texttt{d}};

				% Draw wires from 2 to 1
				\draw[-] (-6, 5.5) to[out=180, in=180] (-1, 13.5)
				node[midway, above] {};
				\draw[-] (-6, 4.5) to[out=180, in=180] (-1, 12.5)
				node[midway, above] {};
				\draw[-] (-6, 3.5) to[out=180, in=180] (-1, 11.5)
				node[midway, above] {};
				\draw[-] (-6, 2.5) to[out=180, in=180] (-1, 10.5)
				node[midway, above] {};

				% Draw wires from 3 to 2
				\draw[-] (8, 5.5) to[out=360, in=360] (3, 13.5) node[midway, above] {};
				\draw[-] (8, 4.5) to[out=360, in=360] (3, 12.5) node[midway, above] {};
				\draw[-] (8, 3.5) to[out=360, in=360] (3, 11.5) node[midway, above] {};
				\draw[-] (8, 2.5) to[out=360, in=360] (3, 10.5)
				node[midway, above] {};

				% Midway wires
				\draw[-] (0.5, 1) -- (1.5, 1) node[midway, above] {\texttt{a}};
				\draw[-] (0.5, 0) -- (1.5, 0) node[midway, above] {\texttt{b}};
				\draw[-] (0.5, -1) -- (1.5, -1) node[midway, above] {\texttt{c}};
				\draw[-] (0.5,-2) -- (1.5,-2) node[midway, above] {\texttt{d}};

				% Draw wires from 1 to midway
				\draw[-] (-2, 5.5) to[out=360, in=180] (0.5, 1) node[midway, above] {};
				\draw[-] (-2, 4.5) to[out=360, in=180] (0.5, 0) node[midway, above] {};
				\draw[-] (-2, 3.5) to[out=360, in=180] (0.5, -1) node[midway, above] {};
				\draw[-] (-2, 2.5) to[out=360, in=180] (0.5, -2) node[midway, above] {};

				% Draw wires from 2 to midway
				\draw[-] (4, 5.5) to[out=180, in=360] (1.5, 1) node[midway, above] {};
				\draw[-] (4, 4.5) to[out=180, in=360] (1.5, 0) node[midway, above] {};
				\draw[-] (4, 3.5) to[out=180, in=360] (1.5, -1) node[midway, above] {};
				\draw[-] (4, 2.5) to[out=180, in=360] (1.5, -2) node[midway, above] {};

				\draw[fill=lightgray] (0,0-15) rectangle (2,4-15) node[midway] {};
				\node at (0+1, 0+10-0.5-25) {$\overline\pi_5$};

				% Draw the wires entering the box
				\draw[-] (-1, 3+10.5-25) -- (0, 3+10.5-25) node[midway,
					above] {\texttt{a}};
				\draw[-] (-1, 2+10.5-25) -- (0, 2+10.5-25) node[midway,
					above] {\texttt{b}};
				\draw[-] (-1, 1+10.5-25) -- (0, 1+10.5-25) node[midway,
					above] {\texttt{c}};
				\draw[-] (-1,0+10.5-25) -- (0,0+10.5-25) node[midway, above]
				{\texttt{d}};

				% Draw the wires exiting the box
				\draw[-] (3+-1, 3+10.5-25) -- (3+0, 3+10.5-25) node[midway,
					above] {\texttt{a}};
				\draw[-] (3+-1, 2+10.5-25) -- (3+0, 2+10.5-25) node[midway,
					above] {\texttt{b}};
				\draw[-] (3+-1, 1+10.5-25) -- (3+0, 1+10.5-25) node[midway,
					above] {\texttt{c}};
				\draw[-] (3+-1,0+10.5-25) -- (3+0,0+10.5-25) node[midway,
					above] {\texttt{d}};

				\draw[fill=lightgray] (0-5,0+2-9) rectangle (2-5,4+2-9) node[midway] {};
				\node at (0-5+1, 0+2-0.5-9) {$\overline\pi_4$};

				% Draw the wires entering the box
				\draw[-] (-13+7, 5.5-9) -- (-13+8,5.5-9) node[midway, above]
				{\texttt{a}};
				\draw[-] (-13+7, 4.5-9) -- (-13+8,4.5-9) node[midway, above]
				{\texttt{b}};
				\draw[-] (-13+7, 3.5-9) -- (-13+8, 3.5-9) node[midway, above]
				{\texttt{c}};
				\draw[-] (-13+7,2.5-9) -- (-13+8, 2.5-9) node[midway, above]
				{\texttt{d}};

				% Draw the wires exiting the box
				\draw[-] (-13+7+3, 5.5-9) -- (-13+8+3,5.5-9) node[midway, above] {};
				\draw[-] (-13+7+3, 4.5-9) -- (-13+8+3,4.5-9) node[midway, above] {};
				\draw[-] (-13+7+3, 3.5-9) -- (-13+8+3, 3.5-9) node[midway, above] {};
				\draw[-] (-13+7+3,2.5-9) -- (-13+8+3, 2.5-9) node[midway, above] {};

				% Draw the box
				\draw[fill=lightgray] (0+5, 0+2-9) rectangle (2+5,4+2-9)
				node[midway] {};
				\node at (0+5+1, 0+2-0.5-9) {$\overline\pi_6$};

				% Draw the wires exiting the box
				\draw[-] (7, 5.5-9) -- (8,5.5-9) node[midway, above] {\texttt{a}};
				\draw[-] (7, 4.5-9) -- (8,4.5-9) node[midway, above] {\texttt{b}};
				\draw[-] (7, 3.5-9) -- (8, 3.5-9) node[midway, above] {\texttt{c}};
				\draw[-] (7,2.5-9) -- (8, 2.5-9) node[midway, above] {\texttt{d}};

				% Draw the wires entering the box
				\draw[-] (4, 5.5-9) -- (5,5.5-9) node[midway, above] {};
				\draw[-] (4, 4.5-9) -- (5,4.5-9) node[midway, above] {};
				\draw[-] (4, 3.5-9) -- (5, 3.5-9) node[midway, above] {};
				\draw[-] (4,2.5-9) -- (5, 2.5-9) node[midway, above] {};

				% Draw wires from 4 to 5
				\draw[-] (-6, 5.5-9) to[out=180, in=180] (-1, 13.5-25)
				node[midway, above] {};
				\draw[-] (-6, 4.5-9) to[out=180, in=180] (-1, 12.5-25)
				node[midway, above] {};
				\draw[-] (-6, 3.5-9) to[out=180, in=180] (-1, 11.5-25)
				node[midway, above] {};
				\draw[-] (-6, 2.5-9) to[out=180, in=180] (-1, 10.5-25)
				node[midway, above] {};

				% Draw wires from 5 to 6
				\draw[-] (8, 5.5-9) to[out=360, in=360] (3, 13.5-25)
				node[midway, above] {};
				\draw[-] (8, 4.5-9) to[out=360, in=360] (3, 12.5-25)
				node[midway, above] {};
				\draw[-] (8, 3.5-9) to[out=360, in=360] (3, 11.5-25)
				node[midway, above] {};
				\draw[-] (8, 2.5-9) to[out=360, in=360] (3, 10.5-25)
				node[midway, above] {};

				% Draw wires from 4 to midway
				\draw[-] (-2, 5.5-9) to[out=360, in=180] (0.5, 1)
				node[midway, above] {};
				\draw[-] (-2, 4.5-9) to[out=360, in=180] (0.5, 0)
				node[midway, above] {};
				\draw[-] (-2, 3.5-9) to[out=360, in=180] (0.5, -1)
				node[midway, above] {};
				\draw[-] (-2, 2.5-9) to[out=360, in=180] (0.5, -2)
				node[midway, above] {};

				% Draw wires from 2 to midway
				\draw[-] (4, 5.5-9) to[out=180, in=360] (1.5, 1) node[midway, above] {};
				\draw[-] (4, 4.5-9) to[out=180, in=360] (1.5, 0) node[midway, above] {};
				\draw[-] (4, 3.5-9) to[out=180, in=360] (1.5, -1)
				node[midway, above] {};
				\draw[-] (4, 2.5-9) to[out=180, in=360] (1.5, -2)
				node[midway, above] {};

				\node[draw,circle] at (-2, -0.5) {\texttt{A}};
				\node[draw,circle] at (-7, -11) {\texttt{B}};
				\node[draw,circle] at (-7, -11+21) {\texttt{B}};
				\node[draw,circle] at (-7+16, -11) {\texttt{C}};
				\node[draw,circle] at (-7+16, -11+21) {\texttt{C}};
			\end{tikzpicture}
		}
	\end{center}
	\caption{Multiple loops in the Bombe}
	\label{fig:multiloops}
\end{figure}
\noindent This increased electrical connections resulting in fewer
stops. We will return in the next chapter to the effect that multiple
loops has on the number of stops.

\subsection{Indicator Drums and Ring Setting}
The Bombe is set up with up to $12$ scramblers
\begin{center}
	$R_{x_1, y_1, z_1},\dots, R_{x_k, y_k, z_k}$
\end{center}
intended to encode the various positions of our Enigma machine while
enciphering our plaintext-ciphertext pairing. We assume that the
initial setting while encoding the message was \texttt{ZZZ}. It will
run through all $26^3$ positions of the Enigma machine until it finds
a stop. Suppose that at a stop the drums have positions
\begin{center}
	$R_{a_1, b_1, c_1},\dots, R_{a_k, b_k, c_k}$.
\end{center}
Given that our supposed ring setting was \texttt{ZZZ} (we will denote
(\texttt{26},
\texttt{26}, \texttt{26})), we now know that a candidate with a ring
setting of (\texttt{26},
\texttt{26}, \texttt{26}) and window setting of $(a_1, b_1, c_1)$
which should produce our expected plaintext at the location of the
first letter included in our loop. Of course, we want the plaintext
from the beginning of our plaintext-ciphertext pairing, so this
should actually occur at a window setting of
\begin{align}
	\label{eq:bombe_stop}
	(\texttt{Z} + (a_1-x_1)\text{ mod }26, \texttt{Z} + (b_1-y_1)\text{
		mod }26, \texttt{Z} + (c_1-z_1)\text{ mod }26)
\end{align}
with a ring setting of (\texttt{26},
\texttt{26}, \texttt{26}). Recall, that our assumed window setting at
the beginning of our plaintext-ciphertext pairing is \texttt{ZZZ}. We
want to move our window setting \ref{eq:bombe_stop} to correspond
with this but, in order to maintain permutation which produced the
stop, we must move the ring setting backwards by the same amount we
must move from \ref{eq:bombe_stop} to \texttt{ZZZ}. This displacement
is given by
\begin{align*}
	((a_1-x_1)\text{ mod }26, (b_1-y_1)\text{ mod }26, (c_1-z_1)\text{ mod }26)
\end{align*}
since the \texttt{Z}s cancel out. Then we must move our assumed ring
setting of (\texttt{26},
\texttt{26}, \texttt{26}) backwards by this same amount giving a ring setting of
\begin{align*}
	(\texttt{26} - (a_1-x_1)\text{ mod }26, \texttt{26} -
	(b_1-y_1)\text{ mod }26, \texttt{26} - (c_1-z_1)\text{ mod }26).
\end{align*}
Notice that $(a_1-x_1, b_1-y_1, c_1-z_1)$ is just the number of steps
our machine has made since it started. So, to get the ring position
corresponding to the start of our plaintext-ciphertext pairing we
just subtract the number of steps each rotor has made from our
assumed ring position (\texttt{26},\texttt{26}, \texttt{26}). Rather
than doing all this math, the Bombe was equipped with an additional
set of {\bf{indicator drums}} which began with labels \texttt{ZZZ}
and for each step the machine moved \emph{forward}, it moved the
indicator drum \emph{backward}. This means that when the machine
stopped, the indicator drums would immediately tell us the ring
setting which corresponded to our plaintext-ciphertext pairing. Then,
with this ring setting, setting our machine to the window setting
\texttt{ZZZ} would produce our expected plaintext-ciphertext
pairing\footnote{The actual rotors used in the Bombe scramblers were
	incorrect and did not match the true Enigma rotors by varying degrees
	of rotation depending on the rotor in question. This meant operators
	did not set their window settings to \texttt{ZZZ} but rather some
	small offset depending on which rotors were included. This meant if
	we used rotors (\texttt{II}, \texttt{V}, \texttt{III}) our window
	setting would be \texttt{YWY}}.

\subsection{Recovering the Plugboard}
Given a stop, we now know that for our hypothesized rotor order, a
window setting of \texttt{ZZZ}, and ring setting given by the
indicator drums we should be able to produce our plaintext-ciphertext
pair. However, we have yet to deduce the plugboard setting. The
genius of the Bombe is that much of the deduction required to workout
the plugboard setting has been done for us. Consider a possible stop
of the Bombe
\begin{center}
	\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
		% Draw the box
		\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

		\node at (3, -2) {$\overline\pi_3$};

		% Draw the wires entering the box
		\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
		\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
		\draw[-, red] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
		\draw[-] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

		% Draw the wires exiting the box with crossed mappings
		\draw[-, red] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
		\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
		\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
		\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

		% Draw the lines inside the box to represent the mapping
		\draw[-] (2, 2) -- (4,0);
		\draw[-] (2, 1) -- (4, -1);
		\draw[-, red] (2, 0) -- (4, 2);
		\draw[-] (2,-1) -- (4, 1);

		\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
		\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
		\draw[-, red] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
		\draw[-] (0-3, -1-7) to[out=180, in=180] (0, -1)
		node[midway, above] {};

		\draw[- ,red] (6+3, 2-7) to[out=360, in=360] (6, 2) node[midway, above] {};
		\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
		\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
		\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

		\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

		\node at (3-3, -2-7) {$\overline\pi_1$};

		% Draw the wires entering the box
		\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
		\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
		\draw[-, red] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
		\draw[-] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

		% Draw the wires exiting the box
		\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
		\draw[-] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
		\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
		\draw[-, red] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

		% Draw the lines inside the box to represent the mapping
		\draw[-] (2-3, 2-7) -- (4-3, 1-7);
		\draw[-] (2-3, 1-7) -- (4-3, 2-7);
		\draw[-, red] (2-3, 0-7) -- (4-3, -1-7);
		\draw[-] (2-3,-1-7) -- (4-3, 0-7);

		\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

		\node at (3+3, -2-7) {$\overline\pi_2$};

		% Draw the wires entering the box
		\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
		\draw[-] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
		\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
		\draw[-, red] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

		% Draw the wires exiting the box
		\draw[-, red] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
		\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
		\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
		\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

		\draw[-] (2+3, 2-7) -- (4+3, -1-7);
		\draw[-] (2+3, 1-7) -- (4+3, 0-7);
		\draw[-] (2+3, 0-7) -- (4+3, 1-7);
		\draw[-, red] (2+3,-1-7) -- (4+3, 2-7);

		\node[draw,circle] at (-4.5, -1) {\texttt{A}};
		\node[draw,circle] at (3, -9) {\texttt{B}};
		\node[draw,circle] at (10.5, -1) {\texttt{C}};

	\end{tikzpicture}
\end{center}
Our hypothesized plugboard setting was that \texttt{A} was steckered
to \texttt{C} and we found no logical contradictions thus producing a
stop. This means that at a minimum we recover that $S(\texttt{A}) =
	\texttt{C}$. However, we may as well have hypothesis that \texttt{B}
was steckered to \texttt{D} and thus we would have applied current to
wire \texttt{Bd}. Note that this wire is included in our connected
component so we would have recovered the exact same stop. That is,
the statement $S(\texttt{B}) = \texttt{D}$ also produced no logical
contradictions. Similarly, reading off cable \texttt{C} we would
recover $S(\texttt{C}) = \texttt{A}$ though we already knew this from
our first hypothesis. Thus, for each cable in our loop we recover a
plugboard setting consistent with our initial hypothesis (though some
of these may be redundant). For a sufficiently long loop we can
recover several plugboard setting just by seeing which wires are
electrified on which cables.
\subsubsection{Checking Machines}
While looking at the internal wiring will, in fact, derive such
plugboard settings, from an operator's perspective the Bombe only
displayed which steckering our cable involved in our initial
hypothesis produced. For this reason, a special device was produced
called a {\bf{checking machine}} whose sole purpose was to derive
these plugboard settings from a stop of the Bombe. We will consider
one such derivation.
% Wren reference https://wrens.org.uk/second-world-war-codebreaker/ %
\\\\The checking machine was effectively an Enigma machine with no
plugboard attachment and no rotor advancement mechanism --
effectively, the checking machine represents a fixed
$\overline\sigma_i$. Suppose the operator (known as a
	{\bf{wren}})\footnote{Wren comes from the abbreviation WRN of the
	Women's Royal Navy Service. Such members became the primary operators
	of Bombes at Bletchley Park.} knew from the Bombe stop that our
hypothesis letter \texttt{A} was steckered to \texttt{C} (i.e.
$S(\texttt{A} = \texttt{C}$)). Further, from our loop the wren might know that
\[
	\sigma_1(\texttt{A}) = \texttt{B}
\]
We then have that
\begin{align*}
	S(\texttt{B}) & = S(\sigma_1(\texttt{A}))                \\
	              & = SS^{-1}\overline\sigma_1 S(\texttt{A}) \\
	              & = \overline\sigma_1(\texttt{D})
\end{align*}
Then to determine what letter is steckered to \texttt{B}, the wren
only needs to set their ring settings to that given by the indicator,
the window settings to that corresponding to $\sigma_1$, and input
\texttt{D}. Now using this newly deduced steckering the wren can
produce the steckering of the next letter in the loop until we have
deduced the steckerings corresponding to each letter in our loop.



% https://archive.org/details/battleofwitscomp00budi PAGE $

\subsubsection{Invalid Stops}
If at this stage we find that a deduced plugboard setting contradicts
an earlier plugboard setting we discovered, this means that the point
at which the Bombe stopped is incorrect! Recall that the Bombe stops
when there are no logical contradictions gleamed from its setup and
the information in the loop -- this does not mean no logical
contradictions exist. Further, even if no logical contradictions
existed that does not mean this is the only such setting which would
be logically consistent with our plaintext (though this is certainly
less likely). The use of the Bombe is thus a trial-and-error
procedure. We run the machine until we find a candidate stop, then we
check for possible further logical contradictions, and if such
contradictions are found we continue from where we left off. Many
additions we discuss later in this chapter are designed with the sole
purpose of reducing the number of stops we need to check down to a
tractable number.
\\\\If we find our stop has valid plugboard settings, we can recover
any remaining settings is quite easily. We can attempt to decrypt our
ciphertext with our window setting of \texttt{ZZZ}, our ring setting
given by the indicator drums, and our plguboard settings we
discovered from the stop. If we find that there are letters which do
not match our expected plaintext we can deduce what plugboard
settings need to be added to switch out incorrect letters with their
correct plaintext letters. In this way we can recover the entirety of
the plugboard settings.


\subsection{Recovering the Ring Settings}\label{bombe_ring_setting}
By this point we know that for our hypothesized rotor ordering, a
window setting of \texttt{ZZZ}, a ring setting given by the indicator
drums, and a plugboard setting deduced from the state of the stop as
well as additional logical induction, we can produce the desired
ciphertext-plaintext pairing. However, this does not mean the ring
setting that we have is the true ring setting. We assumed that
turnover did not occur during our crib so in this case we can adjust
our window setting and ring setting arbitrarily (so long as we keep
their relative distances the same). Of course, eventually turnover
will occur, at which point the discrepancy between our ring setting
and the true ring setting will become apparent.
\\\\We will first illustrate how to recover the true ring setting of
the rightmost rotor. We begin by setting our Enigma as previously
described and inputting the ciphertext. This should produce our
expected plaintext. As we keep inputting ciphertext beyond our known
plaintext we will recover additional plaintext in the message.
Eventually, turnover will occur and we will begin deciphering
gibberish since our ring setting is not the true ring setting. To
account for this, we can move our ring setting forward by one step
(which means we must also move our window setting forward by one to
maintain our permutation) and we can perform the same procedure,
investigating if we get gibberish. Eventually, we will have arrived
at the true ring setting and our deciphering will begin producing
additional plaintext.
\\\\To recover the ring setting of the other two rotors we employ the
same procedure though it requires a great deal of ciphertext as
turnover becomes less and less frequent as we consider the middle and
leftmost rotor respectively.

\subsection{Recovering the Rotor Order}
In its full form the Bombe was constructed with $3$ rows each
equipped with 12 scramblers. For a single plaintext-ciphertext
pairing we could test multiple rotor orders simultaneously. If our
plaintext-ciphertext pairing is shorter than $12$ characters we could
test $3$ rotor orders concurrently. If it is longer then we may need
to split it into two separate pairings spread across multiple rows
meaning that we may only test $1$ or $2$ rotor orders. Further, over
the course of the war many Bombes were produced. This meant that it
was feasible to test all $60$ rotor orderings against our
plaintext-ciphertext pairing to see which orderings generated valid
stops, thus allowing us to deduce the correct rotor order. In doing
this, we have now managed to recover all of the relevant settings of
the daily key.

\subsubsection{Rotor Order Reuse}
German Enigma protocol stipulated that no rotor setting could appear in two months' setting sheets. This meant that if Bletchley were able to regularly deduce Enigma settings they could rule out many rotor orders which no longer needed to be tested the next month.

\subsection{Turnover}
Recall that when we initially set up our Bombe, we set each scrambler
to correspond to a location in our plaintext -- the first location
being $\texttt{ZZZ}$, the second being \texttt{ZZA}, and so on. As
mentioned previously, the assumption that only the righthand rotor
advanced in our window setting while enciphering the plaintext is
only true if no turnover occurs. If turnover occured during the
message encipherment, our machine will not produce correct stops.
\\\\To account for this we will split up our message into multiple
parts. Consider a plaintext-ciphertext pairing that is $26$
characters long. We are guaranteed to have a turnover of the middle
rotor during the encipherment of this message. However, we know that
the turnover must have occured in either the first half or the second
half of the message. Thus, one half of the message assuredly had no
turnover during its encipherment. This means that if we split our
message into two $13$ character plaintext-ciphertext pairings, at
least one of these will produce valid stops which will ultimately
guide us to our daily key. In general, as long as our message is
shorter than $26$ characters we can split the message into components
such that one component is guaranteed to not have turnover. If the
message is longer than $26$ characters there could be $2$ or more
turnovers during encipherment meaning that splitting the text in this
way would no longer guarantee valid stops but, as we will see in our
analysis in the next chapter, a plaintext-ciphertext pairing of
length $26$ is more than sufficient to produce a small number of
stops so this does not present an issue.
\subsection{Cribs and Menus}

% \begin{chapquote}{Gordon Welchman, \textit{The Hut Six Story Page 120}}
%   The bombes were useless without a crib. If a crib could be found by
%   the Hut 6 watch, the task of the bombe was simply to reduce the
%   assumptions of wheel order and scrambler positions that required
%   ``further analysis'' to a managable number.
% \end{chapquote}
We began with the supposition that the
cryptographer is given a known plaintext-ciphertext pairing. Unless
the cryptographer was able to intercept
a set of communications before and after encryption this supposition
seems unrealistic. However, cryptanalysts at Bletchley park
employed two clever tricks that allowed for such pairings to be
deduced with reasonable effectiveness.
\subsubsection{Determining Plaintext}
First, analysts were able to cross-reference known information to theorize likely phrases in a
message. For instance, if the weather on a particular day was windy
with a chance of rain, we would expect that the weather report (which
intellegence knew arrived from specific channels at specific times)
would likely contain phrases like ``weather'', ``wind'', or ``rain''.
\\\\Some sources of plaintext could be manufactured in a process known as {\bf{gardening}}. Bletchley Park could request that the British Air Force ``seed'' a designated location with mines. It would then follow that many messages would make specific mention of that location or port which contained the mines.
\\\\Another source of plaintext lied in the message protocol. If a message was a continuation of another message, the message would begin with \texttt{FORT} (German for ``continued'') followed by the time at which the first messsage was sent. Numbers were ordered by the top row of the keyboard, that is, \texttt{Q} was $1$, \texttt{W} was $2$, and so on.  Thus if a message was sent at $23:30$, and a subsequent message was a continuation, it would begin with \texttt{FORTYWEEPYWEEPY}, where \texttt{Y} is used as a delimiting character.
\subsubsection{Determining Cribs}
The second trick used by analysts was the use of permutation theory to
eliminate locations in the ciphertext where the plaintext could not
feasibly have been enciphered.
% http://www.ellsbury.com/bombe1.htm %
\\\\Recall that one consequence of the Enigma machine being a
conjugate of the reflector is that no letter can be enciphered to
itself. On D-Day the weather report had the following ciphertext
\begin{center}
	\texttt{QFZWRWIVTYRESXBFOGKUHQBAISEZ}
\end{center}
Given that this was a report the weather in the Bay of Biscay, we
suspect it to contain the following plaintext
\begin{center}
	\texttt{WETTERVORHERSAGEBISKAYA}
\end{center}
If we overlay our ciphertext on top of our plaintext as follows
\begin{align*}
	 & \texttt{QFZWRWIVTYRE}{\uline{\texttt{S}}}\texttt{XBFOGKUHQBAISEZ} \\
	 & \texttt{WETTERVORHER}{\uline{\texttt{S}}}\texttt{AGEBISKAYA.....}
\end{align*}
we notice that at the 13th position, the letter \texttt{S} appears in
both the plaintext and the ciphertext. We know that such an
encipherment is impossible and therefore the suspected plaintext
cannot begin at this location. If we slide the plaintext along our
ciphertext we get the following
\begin{align*}
	 & \texttt{QFZWRWIVTYRESXBFOGKUHQBAISEZ}
	\\
	 & \texttt{WETTERVORHER}{\uline{\texttt{S}}}\texttt{AGEBISKAYA.....}
	\\
	 &
	\texttt{.WETTER}{\uline{\texttt{V}}}\texttt{ORH}{\uline{\texttt{E}}}\texttt{RSAGEBISKAY}{\uline{\texttt{A}}}\texttt{....}
	\\
	 & \texttt{..WETTE}{\uline{\texttt{R}}}\texttt{VORHERSAGEBISKAYA...}
	\\
	 &
	\texttt{...}{\uline{\texttt{W}}}\texttt{ETTERVORHERSA}{\uline{\texttt{G}}}\texttt{EBISK}{\uline{\texttt{A}}}\texttt{YA...}
	\\
	 & \texttt{....WETTERVORHERSAGEBISKAYA..}
	\\
\end{align*}
We can see that at offsets $0-3$ we have coincidences between the
plaintext and the ciphertext that would make enciphering at this
position impossible. Only at an offset of $4$ do we observe no
coincidences. Such a potentially valid location for enciphering is
known as a {\bf{crib}}. We may find many such cribs for a given
transmission and suspected plaintext, but if our suspected plaintext
is long the likelihood of this occurring goes down significantly so
we expect to find only a few cribs.
\\\\Now equipped with our crib
\begin{figure}[H]
	\begin{center}
		\texttt{RWIVTYRESXBFOGKUHQBAISE}  \\
		\texttt{WETTERVORHERSAGEBISKAYA} \\
	\end{center}
	\caption{Example crib}
	\label{fig:crib}
\end{figure}
\noindent We can generate a diagramatic representation of our
plaintext-ciphertext pairing called a {\bf{menu}} which will be used
to wire up our Bombe. We assume the enciphering starts with window
setting \texttt{ZZZ} so we will denote which window setting takes
each letter to the next.
\begin{figure}[H]
	\begin{center}
		\scalebox{0.8}{
			\begin{tikzpicture}[>=stealth, every node/.style={}]
				% Manual node positions
				\node (E) at (0,0) {\texttt{E}};
				\node (O) at (3,1.5) {\texttt{0}};
				\node (B) at (0,3) {\texttt{B}};
				\node (U) at (-3,3) {\texttt{U}};
				\node (S) at (6,3) {\texttt{S}};
				\node (Y) at (9,3) {\texttt{Y}};
				\node (G) at (-6,3) {\texttt{G}};
				\node (H) at (0,6) {\texttt{H}};
				\node (X) at (-3,6) {\texttt{X}};
				\node (W) at (3,0) {\texttt{W}};
				\node (R) at (6,0) {\texttt{R}};
				\node (F) at (9,0) {\texttt{F}};
				\node (A) at (-3,0) {\texttt{A}};
				\node (I) at (-3,-3) {\texttt{I}};
				\node (Q) at (-6,-3) {\texttt{Q}};
				\node (T) at (0,-3) {\texttt{T}};
				\node (K) at (-6,0) {\texttt{K}};
				\node (V) at (6,-3) {\texttt{V}};

				% Connections
				\draw[-] (E) -- (W) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (W) -- (R) node[midway, above, sloped] {\texttt{ZZA}};
				\draw[-] (R) -- (F) node[midway, above, sloped] {\texttt{ZZL}};
				\draw[-] (R) -- (Y) node[midway, above, sloped] {\texttt{ZZF}};
				\draw[-] (E) -- (O) node[midway, above, sloped] {\texttt{ZZH}};
				\draw[-] (O) -- (S) node[midway, above, sloped] {\texttt{ZZM}};
				\draw[-] (S) -- (Y) node[midway, above, sloped] {\texttt{ZZV}};
				\draw[-] (R) -- (S) node[midway, above, sloped] {\texttt{ZZI}};
				\draw[-] (B) -- (S) node[midway, above, sloped] {\texttt{ZZS}};
				\draw[-] (E) -- (B) node[midway, above, sloped] {\texttt{ZZK}};
				\draw[-] (B) -- (H) node[midway, above, sloped] {\texttt{ZZQ}};
				\draw[-] (X) -- (H) node[midway, above, sloped] {\texttt{ZZJ}};
				\draw[-] (U) -- (E) node[midway, above, sloped] {\texttt{ZZP}};
				\draw[-] (G) -- (A) node[midway, above, sloped] {\texttt{ZZN}};
				\draw[-] (A) -- (E) node[midway, above, sloped] {\texttt{ZZW}};
				\draw[-] (K) -- (G) node[midway, above, sloped] {\texttt{ZZO}};
				\draw[-] (K) -- (A) node[midway, above, sloped] {\texttt{ZZT}};
				\draw[-] (T) -- (E) node[midway, above, sloped] {\texttt{ZZE}};
				\draw[-] (I) -- (A) node[midway, above, sloped] {\texttt{ZZU}};
				\draw[-] (Q) -- (I) node[midway, above, sloped] {\texttt{ZZR}};
				\draw[-] (I) -- (T) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (T) -- (V) node[midway, above, sloped] {\texttt{ZZD}};
				\draw[-] (V) -- (R) node[midway, above, sloped] {\texttt{ZZG}};

			\end{tikzpicture}}
	\end{center}
	\caption{Example menu}
	\label{fig:menu}
\end{figure}
\noindent Upon looking at this menu one might ask the question of why
we include connections like the one between \texttt{X} and \texttt{H}
if they are not included in any loop? From our earlier machine
description its clear that such connection will never electrify
additional wires. That is, they will only permute the incoming
electrified wires but never increasing the quantity of electrified
wires since there is no feedback. Thus they add no additional value
save for perhaps slightly more plugboard information. However, an
addition to the machine made by Gordon Welchman made use of such
connections and produced more electrified wires even within the loops
themselves, thus reducing the total number of stops needing to be checked.
% the Eniga machine is
% a series of 13 disjoint transpositions. Mathematically, this is
% because at each stage the permutation formed by the machine is just a
% conjugate of the reflector which has a $2^{13}$ cycle-type.
% \\\\ location of \emph{cribs} -- locations in the enciphered text
% that could plausibly have been generated from the suspsected
% plaintext phrases.

\subsection{Diagonal Board}
Recall that a wire \texttt{Xy} becoming electrified is consistent
with the deduction that $S(\texttt{X}) = \texttt{Y}$. But this
deduction is equivalent to the statement $S(\texttt{Y}) =
	\texttt{X}$. It follows then that if we apply current to \texttt{Yx}
this will be entirely consistent with our current deductions and thus
there will be no new logical contradictions introduced by this
additional current. That is, for any wire \texttt{Xy} we can connect
it directly to \texttt{Yx} through what was called a {\bf{diagonal
			board}}. In our diagram this can be viewed as follows
\begin{figure}[H]
	\begin{center}
		\begin{tikzpicture}[thick, scale=0.7, every node/.style={scale=0.7}]
			% Draw the box
			\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

			\node at (3, -2) {$\overline\pi_3$};

			% Draw the wires entering the box
			\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
			\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
			\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
			\draw[-] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box with crossed mappings
			\draw[-] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
			\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
			\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
			\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2, 2) -- (4, -1);
			\draw[-] (2, 1) -- (4, 0);
			\draw[-] (2, 0) -- (4, 1);
			\draw[-] (2,-1) -- (4, 2);

			\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
			\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
			\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
			\draw[-] (0-3, -1-7) to[out=180, in=180] (0, -1)
			node[midway, above] {};

			\draw[-] (6+3, 2-7) to[out=360, in=360] (6, 2) node[midway, above] {};
			\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
			\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
			\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

			\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

			\node at (3-3, -2-7) {$\overline\pi_1$};

			% Draw the wires entering the box
			\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
			\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box
			\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
			\draw[-] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
			\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
			\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2-3, 2-7) -- (4-3, 0-7);
			\draw[-] (2-3, 1-7) -- (4-3, -1-7);
			\draw[-] (2-3, 0-7) -- (4-3, 2-7);
			\draw[-] (2-3,-1-7) -- (4-3, 1-7);

			\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

			\node at (3+3, -2-7) {$\overline\pi_2$};

			% Draw the wires entering the box
			\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
			\draw[-] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
			\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
			\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

			% Draw the wires exiting the box
			\draw[-] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
			\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

			\draw[-] (2+3, 2-7) -- (4+3, -1-7);
			\draw[-] (2+3, 1-7) -- (4+3, 0-7);
			\draw[-] (2+3, 0-7) -- (4+3, 1-7);
			\draw[-] (2+3,-1-7) -- (4+3, 2-7);

			\node[draw,circle] at (-4.5, -1) {\texttt{A}};
			\node[draw,circle] at (3, -9) {\texttt{B}};
			\node[draw,circle] at (10.5, -1) {\texttt{C}};

			% Diagonal wires
			\draw[-, blue, very thick] (3,2-7) to[bend left=20] (-3+0.1, 2-3);
			\draw[fill=white] (-3+0.1, 2-3) circle (0.1);
			\draw[fill=white] (3, 2-7) circle (0.1);

			\draw[-, orange,  very thick] (9-0.1,2-2) to[bend left=20] (-3+0.1, 2-4);
			\draw[fill=white] (9-0.1, 2-2) circle (0.1);
			\draw[fill=white] (-3+0.1, 2-4) circle (0.1);

			\draw[-, purple, very thick] (3,0-7) to[bend right=20] (9-0.1, 2-3);
			\draw[fill=white] (3, 0-7) circle (0.1);
			\draw[fill=white] (9-0.1, 2-3) circle (0.1);

		\end{tikzpicture}
	\end{center}
	\caption{Diagonal wires}
	\label{fig:diagonal}
\end{figure}
\noindent This significantly increases the number of connections,
adding $\frac{k(k-1)}{2}$ new wires where $k$ is the number of
scramblers in the loop. Adding more connections increases electrical
connectivity thus reducing the number of stops. In fact, prior to the
use of the diagonal board, often $3$ loops needed to be present in
the crib to have a tractable number of stops. With the addition of
the diagonal board this could be significantly reduced and made the
use of the Bombe practical.
\\\\For instance, in our example from figure~\ref{fig:diagonal},
without the diagonal such a state would produce a stop with
hypothesis $S(\texttt{A}) = \texttt{D}$. However, adding the diagonal
wires would cause all wires to have current flowing through them --
meaning that our original stop must have been a false one, only
revealed by the addition of new, consistent deductions which ruled
out all possible plugboard settings.
\\\\This also meant that connections in our menu not included in a
loop, such as the connection in \ref{fig:menu} between \texttt{X} and
\texttt{H}, could now produce feedback within our loops through the
diagonal board connections. This made such connections valuable
additions to a menu. This addition was so valuable in making the Bombe a functional means of decrypting Enigma traffic that the Bombe is often called the Turing-Welchman Bombe, as it was their combined contributions and insight that allowed the machine to so effectively produce daily keys.
\\\\While the name often includes only Turing and Welchman, the man who turned the mathematical theory of the Bombe into actual machinery was chief engineer of the British Tabulating Machine Company, Harold ``Doc'' Keen.

\subsection{Consecutive Stecker Knock Out}
In the Air Force Enigma protocol, the plugboard setting was always such that no letter was connected to its neighboring letter in the alphabet (e.g. \texttt{A} cannot be connected to \texttt{B}). Some Bombes had a setting called {\bf{Consecutive Stecker Knock Out (CSKO)}} that allowed for the elimination of some stops which implied consecutive steckerings. This was accomplished by wiring wire \texttt{Ab} to \texttt{Bc} to \texttt{Dc} and so on, with an optional jack that could complete the circuit on the back of the Bombe.
\\\\In general the CSKO circuit not directly eliminate consecutive steckerings. However, consider the case of a stop (which we will later see is quite common) in which every wire save for one is live. This implies that $\overline\pi$ has a cycle structure of $1^125^1$ and that this remaining singleton cycle is the only possible plugboard setting. If this dead wire representing the singleton does not imply any consecutive steckerings then the CSKO circuit will not come into play and the stop would be considered legitimate. If, however, a consecutive steckering like \texttt{Ef} is on the dead wire, we can see how the CSKO circuit will eliminate this stop.
\\\\We know that \texttt{Fe} is the dead wire on cable \texttt{F}, since \texttt{Ef} and \texttt{Fe} are connected via the diagonal board. Then any other wire on cable \texttt{F} must be live. In particular, cable \texttt{Fg} must be live. We know that the CSKO circuit connects \texttt{eF} to \texttt{Fg} so it follows that \texttt{eF} will now become live through the CSKO circuit. This will make live the only remaining wire and so all wires become live. Thus, cases in which the machine would singularly imply consecutive steckering hypotheses, these stops would be eliminated. This reduces the number of stops needing to be checked for Air Force traffic.

\subsection{The Machine Gun}
Even with the Bombe and the diagonal board we still have more
deductions that can be made to rule out certain settings. Consider
our first stop we examined from figure~\ref{fig:correct_stecker}.
\begin{center}
	\begin{minipage}{0.45\textwidth}
		\begin{tikzpicture}[thick, scale=0.4, every node/.style={scale=0.7}]
			% Draw the box
			\draw[fill=lightgray] (2,-1.5) rectangle (4,2.5) node[midway] {};

			\node at (3, -2) {$\overline\pi_3$};

			% Draw the wires entering the box
			\draw[-] (0, 2) -- (2, 2) node[midway, above] {\texttt{a}};
			\draw[-] (0, 1) -- (2, 1) node[midway, above] {\texttt{b}};
			\draw[-] (0, 0) -- (2, 0) node[midway, above] {\texttt{c}};
			\draw[-, red] (0,-1) -- (2,-1) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box with crossed mappings
			\draw[-, red] (4, 2) -- (6,2) node[midway, above] {\texttt{a}};
			\draw[-] (4, 1) -- (6, 1) node[midway, above] {\texttt{b}};
			\draw[-] (4, 0) -- (6, 0) node[midway, above] {\texttt{c}};
			\draw[-] (4,-1) -- (6, -1) node[midway, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2, 2) -- (4,-1);
			\draw[-] (2, 1) -- (4, 0);
			\draw[-] (2, 0) -- (4, 1);
			\draw[-, red] (2,-1) -- (4, 2);

			\draw[-] (0-3, 2-7) to[out=180, in=180] (0, 2) node[midway, above] {};
			\draw[-] (0-3, 1-7) to[out=180, in=180] (0, 1) node[midway, above] {};
			\draw[-] (0-3, 0-7) to[out=180, in=180] (0, 0) node[midway, above] {};
			\draw[-, red] (0-3, -1-7) to[out=180, in=180] (0, -1)
			node[midway, above] {};

			\draw[- ,red] (6+3, 2-7) to[out=360, in=360] (6, 2)
			node[midway, above] {};
			\draw[-] (6+3, 1-7) to[out=360, in=360] (6, 1) node[midway, above] {};
			\draw[-] (6+3, 0-7) to[out=360, in=360] (6, 0) node[midway, above] {};
			\draw[-] (6+3, -1-7) to[out=360, in=360] (6, -1) node[midway, above] {};

			\draw[fill=lightgray] (2-3,-1.5-7) rectangle (4-3,2.5-7) node[midway] {};

			\node at (3-3, -2-7) {$\overline\pi_1$};

			% Draw the wires entering the box
			\draw[-] (0-3, 2-7) -- (2-3, 2-7) node[midway, above] {\texttt{a}};
			\draw[-] (0-3, 1-7) -- (2-3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (0-3, 0-7) -- (2-3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-, red] (0-3,-1-7) -- (2-3,-1-7) node[midway, above] {\texttt{d}};

			% Draw the wires exiting the box
			\draw[-] (4-3, 2-7) -- (6-3,2-7) node[right, above] {\texttt{a}};
			\draw[-, red] (4-3, 1-7) -- (6-3, 1-7) node[right, above] {\texttt{b}};
			\draw[-] (4-3, 0-7) -- (6-3, 0-7) node[right, above] {\texttt{c}};
			\draw[-] (4-3,-1-7) -- (6-3, -1-7) node[right, above] {\texttt{d}};

			% Draw the lines inside the box to represent the mapping
			\draw[-] (2-3, 2-7) -- (4-3, 0-7);
			\draw[-] (2-3, 1-7) -- (4-3, -1-7);
			\draw[-] (2-3, 0-7) -- (4-3, 2-7);
			\draw[-, red] (2-3,-1-7) -- (4-3, 1-7);

			\draw[fill=lightgray] (2+3,-1.5-7) rectangle (4+3,2.5-7) node[midway] {};

			\node at (3+3, -2-7) {$\overline\pi_2$};

			% Draw the wires entering the box
			\draw[-] (0+3, 2-7) -- (2+3, 2-7) node[midway, above] {};
			\draw[-, red] (0+3, 1-7) -- (2+3, 1-7) node[midway, above] {};
			\draw[-] (0+3, 0-7) -- (2+3, 0-7) node[midway, above] {};
			\draw[-] (0+3,-1-7) -- (2+3,-1-7) node[midway, above] {};

			% Draw the wires exiting the box
			\draw[-, red] (4+3, 2-7) -- (6+3,2-7) node[midway, above] {\texttt{a}};
			\draw[-] (4+3, 1-7) -- (6+3, 1-7) node[midway, above] {\texttt{b}};
			\draw[-] (4+3, 0-7) -- (6+3, 0-7) node[midway, above] {\texttt{c}};
			\draw[-] (4+3,-1-7) -- (6+3, -1-7) node[midway, above] {\texttt{d}};

			\draw[-] (2+3, 2-7) -- (4+3, 1-7);
			\draw[-, red] (2+3, 1-7) -- (4+3, 2-7);
			\draw[-] (2+3, 0-7) -- (4+3, -1-7);
			\draw[-] (2+3,-1-7) -- (4+3, 0-7);

			\node[draw,circle] at (-4.5, -1) {\texttt{A}};
			\node[draw,circle] at (3, -9) {\texttt{B}};
			\node[draw,circle] at (10.5, -1) {\texttt{C}};

		\end{tikzpicture}
	\end{minipage}
\end{center}
This stop may seem to imply we found no logical inconsistencies in our
deductions stemming from the hypothesis that $S(\texttt{A}) =
	\texttt{D}$. However, when a wren goes to check the settings found,
they will discover that this setting produces a contradictory
plugboard setting of $S(\texttt{A}) = \texttt{C}$ -- thus ruling out
this stop. Is there a means by which we could have detected this
without having to manually work it out on a checking machine?
\\\\Recall that before we introduced the checking machine, we noted
that the plugboard settings we would deduce from the checking machine
were implictly encoded in the internal state of the wires of the
machine. In particular since wire $\texttt{Ca}$ was active, we could
have immediately deduced that $S(\texttt{A})= \texttt{C}$ without
having to employ a checking machine. However, these wires states are
not easy for a human to read and would require complex manual
analysis of the underlying cables. Instead, a device called the
	{\bf{machine gun}} was developed which examined the state of the
diagonal board at a given stop to determine if logical contradictions
were present among the deduced plugboard settings. When a stop
occurred, the machine gun would be brought in. The device then used a
series of uniselectors to quickly switch through the diagonal board
contacts to search for a pair of deduced steckerings that had a
common letter (thus producing a logical contradiction). The machine
got its name from the sudden loud burst of sound produced when the
uniselectors ran through the diagonal board. The class of Bombes produced with the machine gun were dubbed {\bf{Jumbo Bombes}}.
\\\\Even with such a device many stops still needed to be checked by
the wrens since the machine gun only detected logical inconsistencies
in regards to plugboard setting overlap and thus still produced false stops.

\section{Banburismus}
% http://www.ellsbury.com/profsbk/profsbk-138.htm%
% http://www.ellsbury.com/gne/gne-102.htm%
% https://web.archive.org/web/20160309155544/http://stoneship.org.uk/~steve/banburismus.html %
Early in this chapter we discussed the changes made to the Enigma
protocol that necessitated the use of the Bombe. The changes
discussed applied only to the Army and Air Force. The Navy, on the
other hand, had a completely different set of changes that required
additional insight to allow us to make use of our Bombe on such naval messages.

\subsection{The Naval Enigma}
The German Navy used completely different Enigma models including
\texttt{M1}, \texttt{M2}, \texttt{M3}, and ultimately \texttt{M4},
the last of which actually allowed for the use of four rotors. The
first three models are compatible with the Enigma model \texttt{I}
that we have been discussing so we will not be examining the
differences between these machines in this paper. Further, the
\texttt{M4}'s additional rotor presented additional cryptographic
challenges to cryptanalysts but the underlying theory described above
is the same.
%https://cryptomuseum.com/crypto/enigma/m3/index.htm%
\\\\The most important difference of the Naval Enigma was the
addition of three rotors (rotors \texttt{VI}, \texttt{VII}, and
\texttt{VIII}). These rotors were exclusively used by the German Navy
and they functioned differently than the afformentioned rotors
\texttt{I}-\texttt{V}. In particular, these new rotors had $2$
turnover notches, diametrically opposed, doubling the rate of rotor turnover.
turnover. In theory, these new rotors increased the total rotor
ordering possibilities to $336$, but the naval operating procedure
specified that one of the three rotors in a key sheet \emph{must} be
a naval rotor reducing our rotor ordering space to only $276$.
\\\\The theory underlying the Bombe still allows for the naval Enigma
to be broken, but the additional rotors meant that the workload
required to break such machines was vastly increased. Further, the
additional turnover meant that cribs from naval transmissions no
longer eliminated turnover by splitting the crib into two pieces. If
instead we knew the rotor ordering, we could quickly determine cribs
that ignored turnover and the amount of time we needed to use the
Bombe would be vastly decreased. Turing invented a method by which cryptographers
were able to reduce the possible rotor orderings to a set of only a
few possibilities became known as {\bf{Banburismus}}\footnote{The naming was due to cards used during the process being produced in Banbury, a small market town near Bletchley Park.}. This method took
inspiration from clock method described in
section~\ref{clock_method}. To understand Banburismus we must first
understand the procedure by which naval Enigmas sent messages.
\subsection{The Naval Enigma Protocol}
Unlike Army and Air Force key sheets, which by this point had stopped
including the window setting (\emph{Grundstellung}) in their daily
key, the Navy maintained this parameter of their daily key.
\\\\The naval operators were provided a large book of trigrams via a
	{\bf{{K-Book}}} (\emph{K-Buch}) as well as a large mapping from
bigrams to other bigrams known as a {\bf{bigram table}}. We will not
discuss the exact details of choosing trigrams since they are not of
cryptogrpahic importance, but suffice it to say that the operator
chose two trigrams from the K-Book (e.g. \texttt{CAC} and
\texttt{ABB}) and arranged them in two rows as follows
\begin{align*}
	 & \texttt{.CAC} \\
	 & \texttt{ABB.}
\end{align*}
The operator then chose two random letters (e.g. \texttt{B} and
\texttt{B}) and filled in the remaining slots
\begin{align*}
	 & \texttt{BCAC} \\
	 & \texttt{ABBB}
\end{align*}
Each vertical bigram would then be converted via the bigram table to
a new bigram. That is
\begin{align*}
	 & \texttt{BA} \mapsto \texttt{CC} \\
	 & \texttt{CB} \mapsto \texttt{AA} \\
	 & \texttt{AB} \mapsto \texttt{BC} \\
	 & \texttt{CB} \mapsto \texttt{AA}
\end{align*}
And these new bigrams were then arranged into tetragrams which in our
example produces \texttt{CCAA BCAA}. These two teragrams were then
sent in plaintext at the start of our message. To actually encipher
their message, the operator set their machine to the window setting
specified by the key sheet and enciphered their second chosen trigram
(i.e. \texttt{ABB} to get their message key. We will call the message
key prior to being enciphered the {\bf{pre-message key}} (in our
case \texttt{ABB}). They then set their window setting to the
message key and began enciphering their message.
\\\\The long short of this procedure is that if we have a copy of
the bigram tables, we can work backwards to figure out the
pre-message key for any naval message. This puts us in a very
similar position to the one Rejewski was in when he was able to
deduce message keys but knew nothing else about the machine settings.
%TODO
\\\\TALK ABOUT GETTING THE BIGRAM TABLES
\\\\With the bigram tables in hand, we can assume that for any
naval message we are able to deduce its pre-message key. With this
assumption we will now employ statistical analysis to determine
which rotors were more likely used in the daily key for a particular day.

\subsection{Repeats}
Suppose we find the following two naval Enigma messages
\[
	\setlength{\arraycolsep}{15pt}
	\begin{array}{c | c}
		\texttt{Pre-Message Key} & \texttt{Message}                \\
		\hline
		\texttt{VFG}             & \texttt{GXCYBGDSLVWBDJLKWIP...} \\
		\texttt{VFX}             & \texttt{YNSCFCCPVIPEMSGIZWF...} \\
	\end{array}
\]
We know that after enciphering our pre-message key we will get our
actual message key. Both \texttt{VFG} and \texttt{VFX} will be
enciphered with the same settings (say $\sigma_i$) so we know that
they will be converted to
\begin{align*}
	\texttt{VFG} & \mapsto \sigma_1(V)\sigma_2(F)\sigma_3(G) \\
	\texttt{VFX} & \mapsto \sigma_1(V)\sigma_2(F)\sigma_3(X) \\
\end{align*}
Given that both message keys begin with the letters
$\sigma_1(V)\sigma_2(F)$, we know that they only differ by some
unknown amount in their rightmost letter. Our first goal will be to
determine the distance between $\sigma_3(G)$ and $\sigma_3(X)$.
Note that we know such a distance ranges between $-25$ and $25$ and
we need not consider a distance of $0$ as this would imply the
pre-message keys are the same.
\\\\Recall our discussion from section~\ref{ioc} regarding the
index of coincidence. We know that when two texts represent the
same poly-alphabetic cipher the observed distribution of coincidences
(Bletchley Park called these {\bf{repeats}}) should be much higher
than two texts representing random text. Consider aligning our two
texts with an offset of $+11$ letters, that is, the hypothesis that
$\sigma_3(\texttt{G}) = \sigma_3(\texttt{X}) + 11$
\begin{center}
	\scalebox{0.8}{
		\begin{minipage}{\linewidth}
			\begin{align*}
				\texttt{...........GXCYBGDS}{\dunderline{2pt}{\texttt{L}}}\texttt{VWBDJLKWIPEHVYGQZWDTHR}{\dunderline{2pt}{\texttt{Q}}}\texttt{XIKEESQSSPZXARIXEAB}{\dunderline{2pt}{\texttt{Q}}}\texttt{IRUCKHGWUEBPF}
				 & \\
				\texttt{YNSCFCCPVIPEMSGIZWF}{\dunderline{2pt}{\texttt{L}}}\texttt{HESCIYSPVRXMCFQAXVXDVU}{\dunderline{2pt}{\texttt{Q}}}\texttt{ILBJUABNLKMKDJMENUN}{\dunderline{2pt}{\texttt{Q}}}\texttt{.............}
				 &
			\end{align*}
		\end{minipage}}
\end{center}
In this case we find $3$ repeats when considering an overlap of
length $54$, this repeat structure was denoted as $3/54$.
\\\\For an offset of $-9$ we have
\begin{center}
	\scalebox{0.8}{
		\begin{minipage}{\linewidth}
			\begin{align*}
				\texttt{GXCYBGDSLVWBDJLKWIPEHVY}{\dunderline{2pt}{\texttt{G}}}\texttt{Q}{\dunderline{2pt}{\texttt{Z}}}\texttt{}{\dunderline{2pt}{\texttt{W}}}\texttt{DT}{\dunderline{2pt}{\texttt{H}}}\texttt{RQX}{\dunderline{2pt}{\texttt{I}}}\texttt{KEESQSSPZX}{\dunderline{2pt}{\texttt{A}}}\texttt{RI}{\dunderline{2pt}{\texttt{X}}}\texttt{EAB}{\dunderline{2pt}{\texttt{Q}}}\texttt{}{\dunderline{2pt}{\texttt{I}}}\texttt{RUCKHGWUEBPF.......}
				 & \\
				\texttt{.........YNSCFCCPVIPEMS}{\dunderline{2pt}{\texttt{G}}}\texttt{I}{\dunderline{2pt}{\texttt{Z}}}\texttt{}{\dunderline{2pt}{\texttt{W}}}\texttt{FL}{\dunderline{2pt}{\texttt{H}}}\texttt{ESC}{\dunderline{2pt}{\texttt{I}}}\texttt{YSPVRXMCFQ}{\dunderline{2pt}{\texttt{A}}}\texttt{XV}{\dunderline{2pt}{\texttt{X}}}\texttt{DVU}{\dunderline{2pt}{\texttt{Q}}}\texttt{}{\dunderline{2pt}{\texttt{I}}}\texttt{LBJUABNLKMKDJMENUNQ}
				 &
			\end{align*}
		\end{minipage}}
\end{center}
In this case we find $9$ repeats when considering an overlap of
$56$ characters, but we additionally found two bigrams (\texttt{ZW}
and \texttt{QI}) which were repeated. As bigrams are much more
common in languages than random text, a point we will later
discuss, we must factor this into our analysis. Thus we denote the
repeat structure at this offset as $9^{\texttt{xx}}/56$, where each
$\texttt{x}$ denotes a bigram.\\\\For any other $n$-gram repeat, we
will use the $n$ in the exponent. For example, when considering $3$
repeats in $57$ letters, where we note that there is a trigram
repeated we would denote this repeat structure as $3^{3}/57$. This
is actually the case when examining our messages at an offset of $-8$.
\\\\Examining offsets from $-9$ to $+9$\footnote{In practice all
	offsets from $-25$ to $+25$ would be computed but the table has
	been shorted for brevity} we get the following chart of repeat structures
\begin{center}\scalebox{0.8}{
		\begin{minipage}{\linewidth}
			\begin{table}[H]
				\centering
				\small
				\begin{tabular}{|l|l|}
					\hline
					\textbf{Offset}               & \textbf{Repeat Structure} \\
					\hline
					\texttt{VFG} = \texttt{VFX}-9 & $9^\texttt{xx}/56$        \\
					\texttt{VFG} = \texttt{VFX}-8 & $3^3$/57                  \\
					\texttt{VFG} = \texttt{VFX}-7 & 2/58                      \\
					\texttt{VFG} = \texttt{VFX}-6 & 0/69                      \\
					\texttt{VFG} = \texttt{VFX}-5 & 3/60                      \\
					\texttt{VFG} = \texttt{VFX}-4 & 2/61                      \\
					\texttt{VFG} = \texttt{VFX}-3 & 3/62                      \\
					\texttt{VFG} = \texttt{VFX}-2 & 3/63                      \\
					\texttt{VFG} = \texttt{VFX}-1 & $4^\texttt{x}$/63         \\
					\texttt{VFG} = \texttt{VFX}+1 & 2/63                      \\
					\texttt{VFG} = \texttt{VFX}+2 & 1/63                      \\
					\texttt{VFG} = \texttt{VFX}+3 & 3/62                      \\
					\texttt{VFG} = \texttt{VFX}+4 & 4/61                      \\
					\texttt{VFG} = \texttt{VFX}+5 & 1/60                      \\
					\texttt{VFG} = \texttt{VFX}+6 & 3/59                      \\
					\texttt{VFG} = \texttt{VFX}+7 & 3/58                      \\
					\texttt{VFG} = \texttt{VFX}+8 & 0/57                      \\
					\texttt{VFG} = \texttt{VFX}+9 & 2/56                      \\
					\hline
				\end{tabular}
				\caption{Repeat structure at various offsets}
			\end{table}
		\end{minipage}
	}
\end{center}
The question now arises, which of these offsets is most likely. Of
course an offset of $-9$ has the most repeats, but perhaps the
trigram at an offset of $-8$ makes this case more likely. In order
to answer this question we will need a means to score these repeat
structures. To do this, we must take a brief moment to dicuss
Bayesian statistics.
\subsection{Bayesian Statistics}
Turing thought of the relationships between texts at various
offsets in terms of Bayesian statistics. Recall {\bf{Bayes theorem}}
\begin{theorem}
	Given events $A$ and $B$, where $\mathbb{P}(B) \ne 0$ we have that
	\[
		\mathbb{P}(A|B) = \frac{\mathbb{P}(B|A)\mathbb{P}(A)}{\mathbb{P}(B)}
	\]
\end{theorem}
\noindent This is given in terms of probability. We will see that
the math becomes significantly easier to do in one's head if we
think of these probabilities instead in terms of {\bf{odds}}. That is
\begin{definition}
	For an event $A$ with probability $\mathbb{P}(A)$ we say that the
	odds of $A$ occuring are
	\[
		\mathbb{O}(A) = \frac{\mathbb{P}(A)}{\mathbb{P}(\overline{A})}
	\]
	where $\overline{A}$ denotes the probability of $A$ not occuring,
	that is, $\mathbb{P}(\overline{A}) = 1-\mathbb{P}(A)$.
\end{definition}
\noindent Then we have
\begin{align*}
	\mathbb{O}(A|B) & =
	\frac{\mathbb{P}(A|B)}{\mathbb{P}(\overline{A}|B)}
	\\
	                & =
	\frac{\mathbb{P}(A)}{\mathbb{P}(\overline{A})}\cdot\frac{\mathbb{P}(B|A)\mathbb{P}(B)}{\mathbb{P}(B|\overline{A})\mathbb{P}(B)}
	\\
	                & =
	\frac{\mathbb{P}(A)}{\mathbb{P}(\overline{A})}\cdot\frac{\mathbb{P}(B|A)}{\mathbb{P}(B|\overline{A})}
	\\
	                & =
	\mathbb{O}(A)\cdot\frac{\mathbb{P}(B|A)}{\mathbb{P}(B|\overline{A})}
	\\
\end{align*}
\noindent We will denote
$\frac{\mathbb{P}(B|A)}{\mathbb{P}(B|\overline{A})}$ as
$\mathbb{F}(A,B)$, this is called the {\bf{Bayes factor}}. The
Bayes factor can be thought of as a measurement of how much the
odds of an event increase when we add in a particular hypothesis.
For a subsequent and independent event $C$ we have
\begin{align*}
	\mathbb{O}(A|B\wedge C) & =
	\mathbb{O}(A)\cdot\frac{\mathbb{P}(B\wedge C|
		A)}{\mathbb{P}(B\wedge C| \overline{A})}
	\\
	                        & = \mathbb{O}(A)\cdot\frac{\mathbb{P}(B| A)}{\mathbb{P}(B|
		\overline{A})}\cdot\frac{\mathbb{P}(C|A)}{\mathbb{P}(C|\overline{A})}
	\\
	                        & = \mathbb{O}(A)\cdot \mathbb{F}(A,B) \cdot \mathbb{F}(A,C)
\end{align*}
\noindent Inductively we have that for a series of independent
events $B_1, \dots, B_k$ we get
\[
	\mathbb{O}(A|\wedge_{i=1}^k B_i) =
	\mathbb{O}(A)\cdot\prod_{i=1}^k{\mathbb{F}(A,B_i)}
\]
If we are considering many events $B_i$, then we have to do a lot
of multiplications by hand which are prone to error. For this
reason, we consider the {\bf{log-odds}} of these events occuring,
turning these products into summations. In particular, for log-base $b$
\[
	\log_b\mathbb{O}(A|\wedge_{i=1}^k B_i) =
	\log_b\mathbb{O}(A)+\sum_{i=1}^k{\log_b\mathbb{F}(A,B_i)}
\]
This leads us to the following definition
\begin{definition}
	A {\bf{ban}} is a logarithmic unit of information gained from a
	Bayes factor $\mathbb{F}(A,B)$ such that $1$ ban is equivalent to
	a Bayes factor which illustrates that the odds of event $A$
	occurring are increased ten-fold when $B$ is observed. That is
	\begin{align*}
		            & 10^1 = \mathbb{F}(A,B)                    \\
		\Rightarrow & \log_{10}(\mathbb{F}(A,B)) = 1\text{ ban}
	\end{align*}
	\noindent Subsequently, a {\bf{deciban}} is $\frac{1}{10}$ of a
	ban, representing an event's odds being increased by a factor of
	$10^\frac{1}{10}$, given $B$ occurred. The unit we will be using
	is half of a deciban, known as a {\bf{hubdub (hdB)}},
	representing an event's odds being increased by a factor of
	$10^\frac{1}{20}$, given $B$ occurred. That is
	\[
		20\log_{10}(\mathbb{F}(A,B)) = 1\text{ hdB}
	\]
\end{definition}
\noindent In our case, if we use hubdubs, we arrive at the
following relationship between our odds
\[
	20\log_{10}\mathbb{O}(A|\wedge_{i=1}^k B_i) =
	20\log_{10}\mathbb{O}(A)+\sum_{i=1}^k{20\log_{10}\mathbb{F}(A,B_i)}
\]
Then a series of independent events $B_1, \dots, B_k$ increase the
odds of $A$ by  $\sum_{i=1}^k{20\log_{10}\mathbb{F}(A,B_i)}$ hdB.
Note that if this value is positive this implies that the event $A$
is more likely to have occurred after observing each $B_i$. If this
value is negative, then the event $A$ is less likely to have
occurred after observing each $B_i$. If it is $0$ we have gained no
information.

\subsection{Scoring Charts}
Bletchley Park cryptanalysts precompiled a large chart of how many
hubdubs a particular observation of repeats was worth. Consider
that we observe that at an offset of $-13$ our messages with
pre-message keys \texttt{VFG} and \texttt{VFX} have a $6/52$ repeat
structure. That is, there are $6$ monogram repeats occurring in $52$
characters of observed text. We will call this observed event $B$.
We will call the event that the our overlap is in-depth as $A$.
\\\\To calculate how many hubdubs of information we gain we can compute.
\[
	20\log_{10}\mathbb{F}(A,B) =
	20\log_{10}\frac{\mathbb{P}(B|A)}{\mathbb{P}(B|\overline{A})}
\]
The denominator $\mathbb{P}(B|\overline{A})$ represents the
probability that we observed $6$ repeated monograms in $52$
characters of text, given that our messages were not in-depth, that
is, they both represent random streams of text. This is given by
\[
	\mathbb{P}(B|\overline{A}) = (\frac{1}{26})^6(1-\frac{1}{26})^{(52-6)}
\]
\\\\The numerator $\mathbb{P}(B|\overline{A})$ represents the
probability that we observed $6$ repeated monograms in $52$
characters of text, given that our messages are in-depth, that is,
they both represent streams of German text. Based on observation of
the corpus of naval Enigma messages, analysts determined that a
monogram repeat occurs with a probability of $\frac{1}{17}$. Then
our numerator is given by
\[
	\mathbb{P}(B|A) = (\frac{1}{17})^6(1-\frac{1}{17})^{(52-6)}
\]
It then follows that the observation $B$, that is, that our texts
are shifted at a distance of $-13$ is worth $13.59$ (which
Bletchley Park rounded to $13$) hubdubs of information. That is,
this new observation increases our odds of the messages being
in-depth by a factor of $10^\frac{13}{20}$ -- giving a rougly $5$
to $1$ odds in favor of the text being in-depth. A scoring chart
could be computed for all repeat structures of interest. Repeating
this same calculation for various possible text lengths and number
of repeats we may compute a table representing all hubdub values.
\begin{figure}[H]
	\begin{center}
		\scalebox{0.7}{
			\begin{tabular}{r|rrrrrrrrrrrrrrrrrrrrrrrr}
				    & 40  & 41  & 42  & 43  & 44  & 45  & 46  & 47  & 48  & 49 & 50 & 51
				    & 52  & 53  & 54  & 55  & 56  & 57  & 58  & 59  & 60  & 61
				    & 62  & 63
				\\ \hline
				0   & -7  & -8  & -8  & -8  & -8  & -8  & -9  & -9  & -9  & -9 & -9 &
				-9  & -10 & -10 & -10 & -10 & -10 & -11 & -11 & -11 & -11 &
				-11 & -12 & -12
				\\
				1   & -4  & -4  & -4  & -4  & -4  & -4  & -5  & -5  & -5  & -5 & -5 &
				-6  & -6  & -6  & -6  & -6  & -7  & -7  & -7  & -7  & -7  &
				-7  & -8  & -8
				\\
				2   & 0   & 0   & 0   & 0   & 0   & -1  & -1  & -1  & -1  & -1 & -2 &
				-2  & -2  & -2  & -2  & -2  & -3  & -3  & -3  & -3  & -3  &
				-4  & -4  & -4
				\\
				3   & 4   & 4   & 3   & 3   & 3   & 3   & 3   & 2   & 2   & 2  & 2  &
				2   & 1   & 1   & 1   & 1   & 1   & 1   & 0   & 0   & 0   &
				0   & 0   & 0
				\\
				4   & 8   & 7   & 7   & 7   & 7   & 7   & 6   & 6   & 6   & 6  & 6  &
				6   & 5   & 5   & 5   & 5   & 5   & 4   & 4   & 4   & 4   &
				4   & 3   & 3
				\\
				5   & 11  & 11  & 11  & 11  & 11  & 11  & 10  & 10  & 10  & 10 & 10 &
				9   & 9   & 9   & 9   & 9   & 8   & 8   & 8   & 8   & 8   &
				8   & 7   & 7
				\\
				6   & 15  & 15  & 15  & 15  & 15  & 14  & 14  & 14  & 14  & 14 & 13 &
				13  & 13  & 13  & 13  & 13  & 12  & 12  & 12  & 12  & 12  &
				11  & 11  & 11
				\\
				7   & 19  & 19  & 19  & 19  & 18  & 18  & 18  & 18  & 18  & 18 & 17 &
				17  & 17  & 17  & 17  & 16  & 16  & 16  & 16  & 16  & 15  &
				15  & 15  & 15
				\\
				8   & 23  & 23  & 23  & 23  & 22  & 22  & 22  & 22  & 22  & 21 & 21 &
				21  & 21  & 21  & 20  & 20  & 20  & 20  & 20  & 20  & 19  &
				19  & 19  & 19
				\\
				9   & 27  & 27  & 27  & 26  & 26  & 26  & 26  & 26  & 25  & 25 & 25 &
				25  & 25  & 25  & 24  & 24  & 24  & 24  & 24  & 23  & 23  &
				23  & 23  & 23
				\\
				10  & 31  & 31  & 30  & 30  & 30  & 30  & 30  & 30  & 29  & 29 & 29 &
				29  & 29  & 28  & 28  & 28  & 28  & 28  & 27  & 27  & 27  &
				27  & 27  & 27
				\\
			\end{tabular}}
	\end{center}
	\caption{Scoring sheet for Banburismus}
\end{figure}
\noindent Such a table of hubdub values were called {\bf{scoring
			sheets}} (sometimes called {\bf{deciban sheets}} from when
calculations were done in decibans). The columns represent the
length of text being observed and the rows indicate the number of
repeats. We now know how to score repeat structures which only
contain aligned monograms, but we have yet to account for bigrams or trigrams.

\subsection{Bonus Scoring System} Bletchley Park cryptanalysts used
a bonus system intended to account for the difference in frequency
between monograms, bigrams, and trigrams in German text. The rule
was -- to find the value of a repeat structure find its row and
column location, then add one row for each bigram and four rows for
each trigram. \\\\We will illustrate this rule by example. To find
the approximate hubdub value for an observed repeat structure of
$6^\texttt{xx}/55$ we would examine row $6$ column $55$. However,
to account for the additional two bigrams, we must moved down two
rows (one for each bigram) to row $8$ -- giving a value of $20$
hdB. Similarly, for a repeat structure of $5^3/40$ we would examine
row $4$ column $40$. Then, to account for the trigram we would move
down four rows to row $8$ -- giving a value of $23$ hdB.
\\\\The extent to which this bonus system was accurate as opposed
to an arbitrary heuristic is hard to say. In order to determine the
true hubdub value for a message containing bigrams and trigrams we
would need to examine the entire corpus of Enigma message gathered
for the purpose of Banburismus to determine the relative frequency
of bigrams and trigrams. Bletchley Park cryptanalyst, Hugh Alexander, provides some $n$-gram frequencies as follows
\begin{center}
	\begin{tabular}{|c|c|}
		\hline
		{\bf{$n$-gram}}  & {\bf{Probability}}         \\
		\hline
		\text{Monogram}  & $\frac{1}{17}$             \\
		\text{Tetragram} & $100\cdot\frac{1}{26^4}$   \\
		\text{Hexagram}  & $15000\cdot\frac{1}{26^6}$ \\
		\hline
	\end{tabular}
\end{center}
Sadly, this information does not include bigram or trigram frequencies, and given the destruction of the vast majority of these intercepts it
is unlikely that such a quantity will be amassed so as to be able
to prove the accuracy of this bonus system.
% HUGH ALEXANDER - http://www.ellsbury.com/gne/gne-096.htm
% CRYPTOGRAPHIC HISTORY OF WORK ON THE GERMAN NAVAL ENIGMA %
\\\\However, we can work backwards from the bonus system to attempt
to reverse engineer the bigram frequency. If this frequency lies
within a reasonable estimate of bigram frequencies observed in
German at-large, we can assume that this bonus system was likely
based on careful analysis of actual bigram data in relation to the
scoring table.
\\\\Given a bigram frequency of $\beta$ in our Enigma corpus, we
can approximate that a message with $m$ monograms including $b$
bigrams over $n$ letters has a Bayes factor of
\[
	\frac{(\beta)^b(1-\beta)^{(n-1)-b}}{(\frac{1}{26^2})^b(1-\frac{1}{26^2})^{(n-1)-b}}\cdot\frac{(\frac{1}{17})^{(m-2b)}(1-\frac{1}{17})^{(n-m)}}{(\frac{1}{26})^{(m-2b)}(1-\frac{1}{26})^{(n-m)}}
\]
This makes several assumptions and overestimations. First, this
assumes that having bigrams and monograms are independent events.
Second, this ignores the fact that bigrams placed next to each
other become higher order $n$-grams. However, this will do well
enough to serve as justification for the bonus system.
\\\\By saying that such a Bayes factor is roughly equivalent to
that of the Bayes factor of a message with $m+b$ monograms in $n$
letters, we get
\begin{align*}
	            &
	\frac{(\beta)^b(1-\beta)^{(n-1)-b}}{(\frac{1}{26^2})^b(1-\frac{1}{26^2})^{(n-1)-b}}\cdot\frac{(\frac{1}{17})^{(m-2b)}(1-\frac{1}{17})^{(n-m)}}{(\frac{1}{26})^{(m-2b)}(1-\frac{1}{26})^{(n-m)}}
	\approx
	\frac{(\frac{1}{17})^{m+b}(1-\frac{1}{17})^{n-m-b}}{(\frac{1}{26})^{m+b}(1-\frac{1}{26})^{n-m-b}}
	\\\\
	\Rightarrow &
	\frac{(\beta)^b(1-\beta)^{(n-1)-b}}{(\frac{1}{26^2})^b(1-\frac{1}{26^2})^{(n-1)-b}}\approx
	\frac{(\frac{1}{17})^{3b}(1-\frac{1}{17})^{-b}}{(\frac{1}{26})^{3b}(1-\frac{1}{26})^{-b}}
	\\\\
	\Rightarrow &
	\frac{(\beta)^b(1-\beta)^{(n-1)-b}}{(\frac{1}{26^2})^b(1-\frac{1}{26^2})^{(n-1)-b}}\approx
	(\frac{26}{17})^{3b}(\frac{17\cdot25}{16\cdot26})^b
	\\\\
	\Rightarrow &
	\frac{(\beta)^b(1-\beta)^{(n-1)-b}}{(\frac{1}{26^2})^b(1-\frac{1}{26^2})^{(n-1)-b}}\approx
	(\frac{26^2\cdot25}{17^2\cdot16})^b
\end{align*}
% NSA BIGRAMS -
% chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://www.nsa.gov/portals/75/documents/news-features/declassified-documents/friedman-documents/correspondence/FOLDER_152/41746979078617.pdf
% %

% CITE -
% https://crypto.stackexchange.com/questions/114964/banburismus-and-bonus-scoring-system
% %

% https://arxiv.org/abs/1505.04714 Turings paper on ioc %
\noindent We will now make another assumption. We may not know
$\beta$ but we do expect it to be reasonably small. In an NSA paper
regarding the index of coincidence, they estimate the probability of
bigrams in German to be about $0.0097$. Given that Turing's
estimate of monogram probability of $\frac{1}{17}$ is lower than
the NSA's estimate for German monograms of $0.076$, we may expect
that $\beta$ is reasonably close to, if not lower, than $0.0097$.
Given its small magnitude, the ultimate application of
$20\log_{10}$ to each side will render the term
\[
	\frac{(1-\beta)^{(n-1)-b}}{(1-\frac{1}{26^2})^{(n-1)-b}}
\]
meaningless. Thus as a simplifying assumption this can be ignored.
This leaves us with only a dependence on $b$, allowing us to
approximately guess $\beta$. We have
\[
	\beta^b \approx
	(\frac{25}{17^2\cdot16})^b
\]
Giving us $\beta \approx 0.00540$, or as Hugh Alexander might
write, $\beta \approx 3.65\cdot\frac{1}{26^2}$. Given all the
simplifying assumptions made, this is still in the same magnitude
of probability given by the NSA. Further, this estimate falls in
line with the bonus system since it indicates that the index of
coincidence of bigrams is roughly the cube of the index of
coincidence of monograms -- that is

\[
	\beta\cdot26^2 \approx (\frac{1}{17}\cdot26)^3
\]
whereas we might expect it to be the square, hence the addition of
an extra row for each bigram. Alternately, to put it in terms of
logarithmic odds we have
\[
	20\log_{10}(\beta\cdot26^2) \approx 3\cdot20\log_{10}(\frac{1}{17}\cdot26)
\]
that is, $1$ bigram is worth $3$ monograms in terms of
hubdubs\footnote{In fact, this equation can be used to crudely
	estimate the bigram frequency which makes the bonus system exactly
	work. This is $\beta\approx0.00529$, but the above estimate
	provides arguably more justification.}. Thus we can say with reasonable
confidence that the bonus system rule is grounded in legitimate
data of bigram frequency. The same type of calculation can be done
for trigrams but the goal of this section was to give justification
to the reader that the bonus system is more than just a heuristic.

\subsection{Distance Charts}\label{distance_chart}
Another factor we must account for is rotor turnover. We began with
pre-message keys \texttt{VFG} and \texttt{VFX}, so all of this work
has been assuming that only the last letter of the message key
differs between our text; However, if the middle rotor turns over
between the enciphering of our two pre-message keys, this
assumption no longer holds. We must then ask the question, what is
the likelihood that our two messages have message keys differing by
only their last letter? If we assume that $\sigma_3(\texttt{G}) =
	\sigma_3(\texttt{X}) + n$ (thus corresponding to an offset of
$+n$), then this is the same as asking what is the probability that
a turnover did \emph{not} occur between $\sigma_3(\texttt{G})$ and
$\sigma_3(\texttt{X})$, that is, that a turnover did \emph{not}
occur over $n$ letters distance of encipherment?
\\\\Let $S$ represent the probability we are using an non-naval
Enigma rotor as our rightmost rotor (rotors \texttt{I}-\texttt{V}).
If we are in this case, then we have a $\frac{1}{26}$ chance of
turnover at any given letter, so the likelihood of turnover over a
distance of $n$ letters is thus $\frac{n}{26}$. Thus the likelihood
of \emph{not} turning over is $\frac{26-n}{26}$.
\\\\If we are in the case with $1-S$ probability that we are using
a naval rotor (rotors \texttt{VI}-\texttt{VIII}), then we have a
$\frac{1}{13}$ chance of turning over at any given letter, so the
likelihood of \emph{not} turning over is $\frac{13-n}{13}$. Note
that for $n>13$ we would have a probability of $1$.
\\\\Then our probability of having \emph{not} having rotor turnover
occur over $n$ letters distance of encipherment, which we will
denote $\tau_n$, is
\[
	\tau_n =
	\begin{cases}
		S \cdot \dfrac{26 - n}{26} + (1 - S) \cdot \dfrac{13 - n}{13},
		 & \text{for } n < 13        \\
		S \cdot \dfrac{26 - n}{26}
		 & \text{for } 13 \le n < 26
	\end{cases}
\]
Given that, by protocol, at least one rotor must be a naval rotor
we will now calculate $S$.
\\\\We have $8\cdot7\cdot6$ possible arrangements of rotors for all
possible naval rotors, but $5\cdot4\cdot3$ of these will contain no
naval rotors. Additionally, only $7\cdot6\cdot3$ of these will have
a naval rotor as their rightmost rotor, meaning that the
probability of having a non-naval rotor as your rightmost rotor (i.e. $1-S$) is
\[
	1-S = \frac{7\cdot6\cdot3}{8\cdot7\cdot6 - 5\cdot4\cdot3}
\]
Thus $S\approx0.543$. With this we can now compute the probability
that a given offset represents message keys that only differ in
their rightmost letter. In particular, we will generate a
	{\bf{distance chart}} which associates for each offset, the hubdub
value associated to this probability $\tau_N$. We compute a chart
with offsets from $0$ to $25$ and beneath we will show its
associated hubdub value associated to the likelihood of turnover.
\begin{figure}[H]
	\begin{center}
		\scalebox{0.67}{
			\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
				\hline
				0   & 1   & 2   & 3   & 4   & 5   & 6   & 7   & 8   & 9   & 10 & 11 &
				12  & 13  & 14  & 15  & 16  & 17  & 18  & 19  & 20  & 21  &
				22  & 23  & 24  & 25                                                  \\
				\hline
				0   & -1  & -1  & -2  & -2  & -3  & -4  & -4  & -5  & -6  & -7 & -8 &
				-10 & -11 & -12 & -13 & -14 & -15 & -16 & -17 & -18 & -20 &
				-22 & -24 & -28 & -34                                                 \\
				\hline
			\end{tabular}}
	\end{center}
	\caption{Distance chart}
	\label{fig:distance_chart}
\end{figure}
\subsection{Distance Loss}
We now need to consider how the probability of rotor turnover
occurring effects our original estimates. The probability of
observing a repeated monogram is now no longer just the frequency
of monograms in German, but instead a weighted probability
depending on the offset being examined. In particular we define for
an offset of $n$
\[
	\ell_n \coloneq \tau_n\cdot(\frac{1}{17}) + (1-\tau_n)(\frac{1}{26})
\]
This is the probability of finding a repeated German monogram
weighted by the probability that the message produces a legitimate
comparison of rotors with no turnover between encipherment of the
pre-message keys. We add in the alternative possibility that rotor
turnover did occur between encipherment of the pre-message keys in
which case we expect the distribution of monograms to be random. We
will say that $\ell_n$ represents the probability for a {\bf{loss}}
of $20\log_{10}{\tau_n}$ hdB. Then, for each loss corresponding to
a particular offset, we must recompute our scoring sheets -- though
now instead of using $\frac{1}{17}$ as our probability we will use
$\ell_n$. Here is the scoring table for a loss of $-3$ hdB
\begin{figure}[H]
	\begin{center}
		\scalebox{0.7}{
			\begin{tabular}{r|rrrrrrrrrrrr}
				   & 29 & 30 & 31 & 32 & 33 & 34 & 35 & 36 & 37 & 38 & 39 & 40 \\ \hline
				0  & -4 & -4 & -4 & -4 & -4 & -4 & -5 & -5 & -5 & -5 & -5 & -5 \\
				1  & -1 & -1 & -1 & -1 & -1 & -2 & -2 & -2 & -2 & -2 & -2 & -2 \\
				2  & 1  & 1  & 1  & 1  & 1  & 1  & 1  & 1  & 0  & 0  & 0  & 0  \\
				3  & 4  & 4  & 4  & 4  & 4  & 4  & 4  & 3  & 3  & 3  & 3  & 3  \\
				4  & 7  & 7  & 7  & 7  & 7  & 7  & 6  & 6  & 6  & 6  & 6  & 6  \\
				5  & 10 & 10 & 10 & 10 & 10 & 10 & 9  & 9  & 9  & 9  & 9  & 9  \\
				6  & 13 & 13 & 13 & 13 & 13 & 12 & 12 & 12 & 12 & 12 & 12 & 12 \\
				7  & 16 & 16 & 16 & 16 & 15 & 15 & 15 & 15 & 15 & 15 & 15 & 15 \\
				8  & 19 & 19 & 19 & 18 & 18 & 18 & 18 & 18 & 18 & 18 & 18 & 17 \\
				9  & 22 & 22 & 21 & 21 & 21 & 21 & 21 & 21 & 21 & 21 & 20 & 20 \\
				10 & 25 & 25 & 24 & 24 & 24 & 24 & 24 & 24 & 24 & 23 & 23 & 23 \\
				11 & 28 & 27 & 27 & 27 & 27 & 27 & 27 & 27 & 27 & 26 & 26 & 26 \\
				12 & 30 & 30 & 30 & 30 & 30 & 30 & 30 & 30 & 29 & 29 & 29 & 29 \\
				13 & 33 & 33 & 33 & 33 & 33 & 33 & 33 & 32 & 32 & 32 & 32 & 32 \\
				14 & 36 & 36 & 36 & 36 & 36 & 36 & 35 & 35 & 35 & 35 & 35 & 35 \\
			\end{tabular}}
	\end{center}
	\caption{Scoring sheet for -3 hdB loss}
	\label{fig:loss_sheet}
\end{figure}

% \\\\As we increase the distance between our texts, the likelihood
% that the middle rotor turned over increases. In particular, let
% us denote $\tau$ as the probability the mdidle rotor did
% \emph{not} turn over while analyzing our repeats. Further, let
% $S$ denote the probability that the rightmost rotor is a naval
% rotor, thus having two turnover notches spaces 13 letters apart.
% \\\\If we are using a non-naval rotor, then over $n$ characters,
% theres a $\frac{(26-n)}{26}$ chance we did not turnover (since theres a
%\subsection{Tetra

\subsection{$n$-grams}
We have described scoring for monograms, bigrams, and trigrams, but
messages can easily contain repeats of many more characters. We
know that sheets existed for computing hubdub values of tetragrams
and likely even higher $n$-grams, though how high we cannot
definitively say without more historical sources. We also found no
reference to tetragram sheets save for a couple values used for
examples by Hugh Alexander, thus we will use these same examples
later for reference.
\\\\What we do know is that in order to calculate the log-odds of
tetragrams, messages were separated by the {\bf{crib room}} into
$20$ categories labeled \texttt{I}-\texttt{XX}. Each category
represented a message that was likely to contain a particular
distribution of numerals (since many German numbers are $4$
letters). The exact nature of these categories were not discussed
in any historical documentation found while researching for this paper.
\\\\Within each category there are $13$ subdivisions corresponding
to where a tetragram occurred. The first $10$ subdivisions
represented a tetragram occurring in the first position, second
position, and so on. The $11$th subdivision corresponded to a
tetragram occuring between the $11$th and $30$th position. The
$12$th subdivision corresponded to tetragrams occuring between the
$30$th position until the $30$th to last position. The $13$th
subdivision corresponded to tetragrams occuring in the last $30$
letters of the message. For each category and subdivision, a hubdub
value was given.
\\\\Filling in the values given by Hugh Alexander we provide a
score sheet for tetragrams with missing values
\begin{figure}[H]
	\begin{center}
		\scalebox{0.5}{
			\begin{tabular}{|c|*{20}{c|}}
				\hline
				              & \texttt{I}     & \texttt{II}  & \texttt{III}  & \texttt{IV} &
				\texttt{V}    & \texttt{VI}    & \texttt{VII} & \texttt{VIII} &
				\texttt{IX}   & \texttt{X}     & \texttt{XI}  & \texttt{XII}  &
				\texttt{XIII} & \texttt{XIV}   & \texttt{XV}  & \texttt{XVI}  &
				\texttt{XVII} & \texttt{XVIII} & \texttt{XIX} & \texttt{XX}                   \\
				\hline
				1             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				2             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				3             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				4             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				5             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				6             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				7             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				8             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				9             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				10            & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				11            & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				12            & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & {\bf{19}}    & ?             & ?
				              & {\bf{23}}      & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				13            & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?           &
				?             & ?              & ?            & ?             & ?
				              & ?              & ?            & ?             & ?
				              & ?              & ?            & ?                             \\
				\hline
			\end{tabular}}
	\end{center}
	\caption{Scoring sheet for tetragrams with the only known values filled in}
\end{figure}
\noindent In practice, to score a pair of messages with repeat structure
$11^{4\texttt{x}}/60$, we would first consult our tetragram scoring
sheet for both our message categories and tetragram locations to get our
log-odds score by summing the two entries\footnote{Technically we would need to add in the loss corresponding to our offset when computing our tetra scoring sheet. Alexander does not appear to do this but instead just subtracted the loss at the end. This approximation works sufficiently well in many cases but it is worth noting this discrepancy. }. We would then consult the relevant score chart to score
the remaining $7^\texttt{x}/56$ repeat structure, adding these two
scores together to get our total score for this repeat structure.
With this we can now score any repeat structure, save for one
exception we will now discuss.

\subsection{Dummyismus}
There is one more caveat we need to address before we are ready to
fully score our repeat structures. Based on observation,
cryptanalysts at Bletchley Park noted that some percentage of
messages turned into ``dummy'' messages some way through. That is,
short sections of German text follow by gibberish. Dealing with
such messages became known as {\bf{dummyismus}}.
\\\\Cryptanalysts in the crib room  based on length, frequency,
cateogry, etc., would place a {\bf{blue line}} at some point in
each message beyond which they estimated there was a $25\%$ chance
or higher of the message being a dummy, they denoted this
percentage on the sheet corresponding to each message.
\\\\How they determined where to place the blue line and what
percentage likelihood beyond this point the message was a dummy is
not discuss by Hugh Alexander and likely depended on a number of
additional factors which were known to the crib room but may remain
a mystery to us.
\\\\In practice, if we are scoring a repeat structure of $0/30$
before the blue line and $11^{3\texttt{x}}/171$ after it, we would
first score $0/30$ as we have done before, but then score
$11^{3\texttt{X}}/171$ on the sheet corresponding to its offset
loss plus the loss of both messages estimated by the dummyismus protocol.
\\\\To see this, suppose our two messages have $d_1$ and $d_2$
probability respectively of being a dummy after the blue line. Then there is a
\[
	(1-d_1)\cdot(1-d_2)
\]
chance of our messages both being genuine beyond the blue line. We
can compute a lookup table in hdB for all percentages they
encountered as follows
\begin{figure}[H]
	\begin{center}
		\scalebox{0.7}{
			\begin{tabular}{c|ccccccccccccccc}
				     & 0\%  & 5\%  & 10\% & 15\% & 20\% & 25\% & 30\% & 35\% &
				40\% & 45\% & 50\% & 55\% & 60\% & 65\% & 70\%                 \\ \hline
				0\%  & 0    & 0    & -1   & -1   & -2   & -2   & -3   & -4
				     & -4   & -5   & -6   & -7   & -8   & -9   & -10           \\
				5\%  & 0    & -1   & -1   & -2   & -2   & -3   & -4   & -4
				     & -5   & -6   & -6   & -7   & -8   & -10  & -11           \\
				10\% & -1   & -1   & -2   & -2   & -3   & -3   & -4   & -5
				     & -5   & -6   & -7   & -8   & -9   & -10  & -11           \\
				15\% & -1   & -2   & -2   & -3   & -3   & -4   & -5   & -5
				     & -6   & -7   & -7   & -8   & -9   & -11  & -12           \\
				20\% & -2   & -2   & -3   & -3   & -4   & -4   & -5   & -6
				     & -6   & -7   & -8   & -9   & -10  & -11  & -12           \\
				25\% & -2   & -3   & -3   & -4   & -4   & -5   & -6   & -6
				     & -7   & -8   & -9   & -9   & -10  & -12  & -13           \\
				30\% & -3   & -4   & -4   & -5   & -5   & -6   & -6   & -7
				     & -8   & -8   & -9   & -10  & -11  & -12  & -14           \\
				35\% & -4   & -4   & -5   & -5   & -6   & -6   & -7   & -7
				     & -8   & -9   & -10  & -11  & -12  & -13  & -14           \\
				40\% & -4   & -5   & -5   & -6   & -6   & -7   & -8   & -8
				     & -9   & -10  & -10  & -11  & -12  & -14  & -15           \\
				45\% & -5   & -6   & -6   & -7   & -7   & -8   & -8   & -9
				     & -10  & -10  & -11  & -12  & -13  & -14  & -16           \\
				50\% & -6   & -6   & -7   & -7   & -8   & -9   & -9   & -10
				     & -10  & -11  & -12  & -13  & -14  & -15  & -16           \\
				55\% & -7   & -7   & -8   & -8   & -9   & -9   & -10  & -11
				     & -11  & -12  & -13  & -14  & -15  & -16  & -17           \\
				60\% & -8   & -8   & -9   & -9   & -10  & -10  & -11  & -12
				     & -12  & -13  & -14  & -15  & -16  & -17  & -18           \\
				65\% & -9   & -10  & -10  & -11  & -11  & -12  & -12  & -13
				     & -14  & -14  & -15  & -16  & -17  & -18  & -20           \\
				70\% & -10  & -11  & -11  & -12  & -12  & -13  & -14  & -14
				     & -15  & -16  & -16  & -17  & -18  & -20  & -21           \\
			\end{tabular}}
	\end{center}
	\caption{Dummyismus scoring sheet}
\end{figure}
\noindent We now have all the details necessary to score to
messages whose pre-message key differs by only their last letter.

\subsection{End-Wheel Comparison}
We are finally ready to begin the process of {\bf{decibanning}}
based on end-wheel comparisons. Many of Hugh Alexander's scores do
not align consistently with reproduced sheets and there are many
points at which he likely switches between references to decibans
and hubdubs. For this reason we will be using numbers given by
Steven Hosgood in \emph{All You Ever Wanted to Know About
	Banburismus but were Afraid to Ask} as these more consistently align
with the above description. The reader is recommended to examine
this resource for more detailed discussion about the scoring
discrepancies between his analysis and those of Hugh Alexander.
Regardless, the underlying theory is the same and the above
discussion should give the reader and understanding of how such
sheets looked and were used. We will give several examples to
illustrate the various odd scenarios of decibanning.
\subsubsection{\texttt{TYQ = TYB + 5}}
\text{}\\Suppose we are examining the hypothesis that pre-message
keys \texttt{TYQ} and \texttt{TYB} represent an offset of $+5$. At
this offset, we observe a repeat structure of $7^\texttt{xx}/32$,
with no section after the blue line. Consulting our distance chart
from figure~\ref{fig:distance_chart}, a $+5$ offset gives us a loss
of $-3$ hdB. We then get our score sheet calculated for a loss of
$-3$ hdB from figure~\ref{fig:loss_sheet} and consult row $7$
column $32$. Then, according to our bonus system, we move down one
row for each bigram to row $9$ -- giving us a score of $21$ hdB. We
now enter this score in a  {\bf{deciban sheet}}. The sheet will
show each offset and the associated score. Further, it will
indicate which two letters are being compared, in our case
\texttt{Q} and \texttt{B}. In our case we would fill in

\begin{figure}[H]
	\begin{center}
		\scalebox{0.8}{
			\begin{tabular}{c|c|c|c|c|c|c|c|c|c|c|c}
				\cline{2-11}
				              & \dots & -1 & \texttt{  }  & +1            & +2 & +3 & +4 & +5 & +6 &
				\dots         &                                                                      \\
				\cline{2-11}
				\texttt{B   } & \dots & ?  & \texttt{ Q } & ?             & ?  & ?  &
				?             & 22    & ?  & \dots        & \texttt{   B}                            \\
				\cline{2-11}
			\end{tabular}}
	\end{center}
	\caption{End-wheel comparison for \texttt{Q} and \texttt{B}}
\end{figure}

\noindent If we had other pre-message keys which added observations
regarding these distances (e.g. \texttt{POQ} and \texttt{POB}),
then we would add another row below this and we could add up each
column to get a more accurate score for each offset.

\subsubsection{\texttt{ASL = ASJ + 5}}
\text{}\\\\Suppose we are examining the hypothesis that pre-message
keys \texttt{ASL} and \texttt{ASJ} represent an offset of $+5$. At
this offset, we observe a repeat structure of $0/30$ before the
blue line, and $11^\texttt{3x}/171$ after the blue line. For the
repeats before the blue line, consulting our distance chart from
figure~\ref{fig:distance_chart}, a $+5$ offset gives us a loss of
$-3$ hdB. We then get our score sheet calculated for a loss of $-3$
hdB from figure~\ref{fig:loss_sheet} and consult row $0$ column
$30$ to get a score of $-4$ hdB. For the section after the blue
line, the crib room estimates a $-4$ hdB loss due to the
possibility that either is a dummy message. In this case, we must
add this to our original loss of $-3$ due to distance, so we will
ultimately consult a score sheet calculated for a loss of $-7$ hdB.
Such a score sheet is
\begin{figure}[H]
	\begin{center}
		\scalebox{0.8}{
			\begin{tabular}{r|rrrrrrrrrrrr}
				   & 167 & 168 & 169 & 170 & 171 & 172 & 173 & 174 & 175 & 176
				   & 177 & 178                                                 \\ \hline
				10 & 5   & 5   & 5   & 5   & 5   & 5   & 4   & 4   & 4   &
				4  & 4   & 4                                                   \\
				11 & 7   & 7   & 7   & 7   & 7   & 6   & 6   & 6   & 6   &
				6  & 6   & 6                                                   \\
				12 & 9   & 9   & 9   & 9   & 8   & 8   & 8   & 8   & 8   &
				8  & 8   & 8                                                   \\
				13 & 11  & 11  & 11  & 11  & 10  & 10  & 10  & 10  & 10  &
				10 & 10  & 10                                                  \\
				14 & 13  & 13  & 13  & 12  & 12  & 12  & 12  & 12  & 12  &
				12 & 12  & 12                                                  \\
				15 & 15  & 15  & 14  & 14  & 14  & 14  & 14  & 14  & 14  &
				14 & 14  & 14                                                  \\
				16 & 17  & 16  & 16  & 16  & 16  & 16  & 16  & 16  & 16  &
				16 & 16  & 16                                                  \\
				17 & 18  & 18  & 18  & 18  & 18  & 18  & 18  & 18  & 18  &
				18 & 18  & 18                                                  \\
				18 & 20  & 20  & 20  & 20  & 20  & 20  & 20  & 20  & 20  &
				20 & 20  & 19                                                  \\
				19 & 22  & 22  & 22  & 22  & 22  & 22  & 22  & 22  & 22  &
				22 & 21  & 21                                                  \\
				20 & 24  & 24  & 24  & 24  & 24  & 24  & 24  & 24  & 24  &
				23 & 23  & 23                                                  \\
				21 & 26  & 26  & 26  & 26  & 26  & 26  & 26  & 26  & 26  &
				25 & 25  & 25                                                  \\
				22 & 28  & 28  & 28  & 28  & 28  & 28  & 28  & 28  & 27  &
				27 & 27  & 27                                                  \\
				23 & 30  & 30  & 30  & 30  & 30  & 30  & 30  & 29  & 29  &
				29 & 29  & 29                                                  \\
				24 & 32  & 32  & 32  & 32  & 32  & 32  & 31  & 31  & 31  &
				31 & 31  & 31                                                  \\
			\end{tabular}}
	\end{center}
	\caption{Score sheet for $-7$ hdB loss}
\end{figure}
\noindent Given that our repeat structure after the blue line is
$11^\texttt{3x}/171$, we first consult row $11$ column $171$. Then,
according to our bonus system, we move down one row for the bigram
and four rows for the trigram to row $16$ -- giving us a score of
$16$. Adding these two scores together we get a total score for
this offset of $12$ which we would similarly record in the
end-wheel comparison sheet for \texttt{L} and \texttt{J}.
\\\\Eventually, we will have computed scores across many messages
and many offsets, and our deciban sheet will slowly be filled
out. An example deciban sheet is given for comparing \texttt{V}
and \texttt{W} derived from pre-message keys
\texttt{ZOV}/\texttt{ZOW} and \texttt{GMV}/\texttt{GMW} respectively.
\begin{figure}[H]
	\begin{center}
		\scalebox{0.6}{
			\begin{tabular}{c|*{27}{c|}c}
				\cline{2-28}
				              & -13 & -12 & -11 & -10       & -9  & -8            & -7  & -6  & -5 & -4 &
				-3            & -2  & -1  &     & 1         & 2   & 3             & 4   & 5
				              & 6   & 7   & 8   & 9         & 10  & 11            & 12  & 13  &                \\
				\cline{2-28}
				\texttt{V   } & -3  & -3  & -3  & 0         & -8  & 6             & -6  & 6
				              & -12 & -8  & -8  & 23        & 0   & \texttt{   W} & 3   & -12
				              & -8  & 7   & -3  & -6        & -6  & -2            & 1   & -7  & 6  & 3  & -2 &
				\texttt{   V}                                                                                  \\

				\cline{2-28}
				\texttt{W   } & -1  & 2   & -2  & 9         & -2  & -1            & -7  & 17
				              & 2   & 2   & -5  & 4         & -24 & \texttt{   W} & -6  & -6
				              & 4   & -3  & -4  & 2         & 4   & 5             & -1  & -9  & -7 & -2 & 0  &
				\texttt{   V}                                                                                  \\
				\cline{2-28}
				\cline{2-28}
				\texttt{Sum } & -4  & -3  & 1   & 9         & -10 & 5             & -13 & 23
				              & -1  & -6  & -13 & {\bf{27}} & -24 & \texttt{}     & -3  & -18
				              & -4  & 4   & -7  & -4        & -2  & 3             & 0   & -16 & -1 & 1  & -2 &
				\texttt{ Sum}                                                                                  \\
				\cline{2-28}
			\end{tabular}}
	\end{center}

	\caption{End-wheel deciban sheet for \texttt{V} and \texttt{W} with
		summation on the bottom }
\end{figure}
\noindent After all this work we can now determine that the most
likely candidate is that
\[
	\texttt{W} = \texttt{V} - 2
\]
with a total score of $27$ hdB. We can now add in the Bayesian
prior representing the initial odds that any given offset is
correct, which we denoted $\mathbb{O}(A)$. We have that there are
$50$ possible offsets, all of which are equally likely, giving us
an extra factor of $-34$ hdB to get the true odds of our candidate
as $-7$ hdB or roughly $2$ to $1$ odds against our candidate. These sheets will ultimately be used to disambiguate our deduced rotor possibilities. Later when we show deciban sheets, we will show scores already being adjusted by the prior odds to make our work easier.

\subsection{Middle-Wheel Comparison}
So far we have only examined pre-message keys with their first two
letters in common. In theory, there is no reason the same process
cannot be applied to pre-message keys with their first letter in
common, although this requires significantly more offsets being
considered and significantly reduced odds.
\\\\We might think we need to handle all offsets from $-650$ to $+650$ but in practice, naval Enigma operating procedure restricted message lengths to $250$ characters. Thus, we can only examine offsets of $-250$ to $+250$. This is still an incredible number of offsets to check by hand. To handle this, a section at Bletchley Park known as the {\bf{Freebornery}} used tabulating machines to find repeats of length $4$ or greater, since shorter $n$-grams were not worth the considerable odds against such a large array of candidates. Messages with $4$ or more repeats were compiled into a {\bf{tetra catalogue}} as follows

\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|l|}
		\hline
		\textbf{Pre-Message Key} & \textbf{Position} & \textbf{Letters}                                                                                                                                                                                                                                        \\
		\hline
		\texttt{AJU}             & 4.8               & \texttt{LK TNSV RAJTLK}                                                                                                                                                                                                                                 \\
		\texttt{BYX}             & 6.5               & \texttt{CS TNSV AVYTXK}                                                                                                                                                                                                                                 \\
		\texttt{ARX}             & 5.6               & \texttt{A}{\uline{\texttt{U}}}\texttt{ }{\uline{\texttt{T}}}\texttt{}{\uline{\texttt{N}}}\texttt{}{\uline{\texttt{T}}}\texttt{}{\uline{\texttt{B}}}\texttt{ }{\uline{\texttt{L}}}\texttt{}{\uline{\texttt{Y}}}\texttt{}{\uline{\texttt{D}}}\texttt{RMJ} \\
		\texttt{AYR}             & 11.11             & \texttt{X}{\uline{\texttt{U}}}\texttt{ }{\uline{\texttt{T}}}\texttt{}{\uline{\texttt{N}}}\texttt{}{\uline{\texttt{T}}}\texttt{}{\uline{\texttt{B}}}\texttt{ }{\uline{\texttt{L}}}\texttt{}{\uline{\texttt{Y}}}\texttt{}{\uline{\texttt{D}}}\texttt{ACV} \\
		\texttt{CRS}             & 6.1               & \texttt{NC TNXJ AVUSYM}                                                                                                                                                                                                                                 \\
		\texttt{CQT}             & 8.4               & \texttt{}{\texttt{N}}\texttt{L TNXJ BRXSTO}                                                                                                                                                                                                             \\
		\hline
	\end{tabular}
	\caption{Example tetragram catalogue}
\end{table}
\noindent Here we only underline repeats which are longer than $4$ letters as these have the best chance at being legitimate. We think of each rightmost rotor position as having an alphabet of ``26'' letters before it turns over to a new alphabet of 26 letters. The left number in the position column denotes which alphabet we in and the right number indicates which letter we are in that alphabet when the $n$-gram occurred. In this sense our first tetragram entry with a position of $4.8$ means that the tetragram occurred in the $8$th letter of the $4$th alphabet, thus this occurred at the $26\cdot3 + 8$ or $86$th letter of the message. It is worth noting that in this notation, for pre-message keys which differ by only their rightmost letter (as in the last section) an offset of $+n$ can be written as $+0.n$. In the end this will allow us to have one sheet with consistent notation representing all our analyzed messages.

\subsubsection{Left Rotor Distance Charts}
To score these messages the first thing we must do is generate a new distance chart for all possible rotor turnovers between all $-250$ to $+250$ offsets. As before we would like to get a probability $\tau_n$ that our offset represents a legitimate comparison between message keys with their leftmost letter in common. This is the same as asking the probability that turnover of the leftmost rotor dd \emph{not} occur. Now we need to consider more scenarios than in our one rotor analysis. Recall that there are $8\cdot7\cdot6$ total arrangements of rotors but $5\cdot4\cdot3$ of these are not allowed since they do not include any naval rotors. Then there are $276$ total rotor combinations we are examining. The two rightmost rotors can be in one of the following cases
\begin{itemize}
	\item Two non-naval rotors -- For each of the $3$ naval rotors as the lefthand rotor we have $5\cdot4$ possible non-naval rotor combinations for the right two rotors, giving $60$ such combinations.
	\item Two naval rotors --  We have $3\cdot2$ possible naval rotor combinations for the right two rotors, leaving $6$ remaining rotor possibilities for the leftmost rotor, thus giving $36$ such combinations.
	\item Middle naval rotor and rightmost non-naval rotor --  We have $3\cdot5$ possible naval rotor combinations for the right two rotors, leaving $6$ remaining rotor possibilities for the leftmost rotor, thus giving $90$ such combinations.
	\item Middle non-naval rotor and rightmost naval rotor --  As above this has $90$ combinations.
\end{itemize}

For each of this cases we have varying likelihood of rotor turnover. Recall that when dealing with the leftmost rotors period of turnover we must consider double stepping as described in section~\ref{double_step}. Thus we have

\begin{itemize}
	\item Two non-naval rotors -- Leftmost rotor turns with a $26\cdot25 = 650$ period.
	\item Two naval rotors --  Leftmost rotor turns with a $13\cdot12 = 156$ period.
	\item Middle naval rotor and rightmost non-naval rotor --  Leftmost rotor turns with a $26\cdot12 = 312$ period.
	\item Middle non-naval rotor and rightmost naval rotor --  Leftmost rotor turns with a $13\cdot25 = 325$ period.
\end{itemize}

Using the same arguments to compute $\tau_n$ as in section~\ref{distance_chart} we get
\[
	\tau_n =
	\begin{cases}
		\frac{60}{276} \cdot \frac{650 - n}{650} + \frac{90}{276} \cdot \frac{325 - n}{325} + \frac{90}{276} \cdot \frac{312 - n}{312} + \frac{36}{276} \cdot \frac{156 - n}{156},
		 & \text{for } n < 156          \\
		\frac{60}{276} \cdot \frac{650 - n}{650} + \frac{90}{276} \cdot \frac{325 - n}{325} + \frac{90}{276} \cdot \frac{312 - n}{312},
		 & \text{for } 156 \le  n < 312 \\
		\frac{60}{276} \cdot \frac{650 - n}{650} + \frac{90}{276} \cdot \frac{325 - n}{325},
		 & \text{for } 312 \le  n < 325 \\
		\frac{60}{276} \cdot \frac{650 - n}{650}
		 & \text{for } 325 \le  n < 650
	\end{cases}
\]
This lets us compute $\tau_n$ from up to an offset of $\pm650$ but as mentioned we will only need this for $\pm250$. We can now generate a distance chart as before but now we consider each value from in the range $-250$ to $+250$.
\begin{figure}[H]
	\begin{center}
		\scalebox{0.6}{
			\begin{tabular}{c|*{26}{c}}

				  & 0   & 1   & 2   & 3   & 4   & 5   & 6   & 7   & 8   & 9   & 10  & 11  & 12  & 13  & 14  & 15  & 16  & 17  & 18  & 19  & 20  & 21  & 22  & 23  & 24  & 25  \\
				\hline
				0 & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 0   & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  \\

				1 & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -1  & -2  & -2  \\

				2 & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  & -2  \\

				3 & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  & -3  \\

				4 & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -4  & -5  & -5  & -5  & -5  \\

				5 & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -5  & -6  & -6  & -6  & -6  & -6  & -6  & -6  & -6  & -6  & -6  \\

				6 & -6  & -6  & -6  & -6  & -6  & -6  & -6  & -6  & -6  & -6  & -6  & -7  & -7  & -7  & -7  & -7  & -7  & -7  & -7  & -7  & -7  & -7  & -7  & -7  & -7  & -7  \\

				7 & -7  & -7  & -7  & -7  & -7  & -7  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  & -8  \\

				8 & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -9  & -10 & -10 & -10 & -10 & -10 & -10 & -10 & -10 & -10 \\

				9 & -10 & -10 & -10 & -10 & -10 & -10 & -11 & -11 & -11 & -11 & -11 & -11 & -11 & -11 & -11 & -11 & -11 & -11 & -11 & -11 & -12 & -12 & -12 & -12 & -12 & -12 \\
			\end{tabular}}
	\end{center}
	\caption{Distance chart for left rotor turnover}
\end{figure}
\noindent With this chart we now know what the loss for our scoring sheet needs to be for a particular message pair. From here we can use our exact same scoring method to compute the log-odds of score for entries in the tetragram catalogue. To the the true odds of our candidate offset we must consider the Bayesian prior representing the initial odds that any given offset is correct. We have that there are $1300$ possible offsets, all of which are equally likely, giving us an extra factor of $-62$ hdB to get the true odds of our candidate.
\subsubsection{Score Conversion} A candidate offset on the tetragram catalogue does not just store information about the middle wheel but also additional information about the end wheel which we can use to further increase accuracy of our end wheel comparison. In order to do this, we need to determine our score with respect to the Bayesian prior for representing the initial odds of an offset in $\pm25$ being correct. Given that we have used the same scoring system regardless of analyzing middle-wheel and end-wheel comparisons, we have that the Bayesian factors we have computed would be the same whether we were analyzing middle-wheel or end-wheel comparisons. Thus, we need only account for the difference in the prior odds between middle-wheel and end-wheel comparisons. We have $-62$ hdB prior log-odds for middle-wheel comparison and $-34$ hdB log-odds for end-wheel comparison. Thus to convert our score to that of an end wheel comparison we must incur a loss of $-34-62 = -28$ hdB. If $p$ is the probability that our messages are in-depth, then we have that the odds with a loss of $-28$ hdB incurred is
\begin{align*}
	 & \frac{p\cdot10^{\frac{-28}{20}} + (1-p)(1-10^{\frac{-28}{20}})}{(1-p)} \\
	 & = 10^{\frac{-28}{20}}\frac{p}{1-p}-10^{\frac{-28}{20}} + 1
\end{align*}
Note that $\frac{p}{1-p}$ is just our current odds and the above equation is our new odds. Then for a score of $s$, we have $10^\frac{s}{20} = \frac{p}{1-p}$. Thus, to convert from a middle-wheel to an end-wheel comparison, we compute
\[
	20\log_{10}(10^\frac{s}{20}\cdot10^{\frac{-28}{20}} -10^{\frac{-28}{20}} + 1)
\]


\noindent We can compute a conversion chart from middle-wheel scores to end-wheel scores as follows
\begin{figure}[H]
	\begin{center}
		\scalebox{0.6}{
			\begin{tabular}{|c|*{40}{c|}}
				\hline
				{\bf{Middle-wheel Score}} & 15 & 16 & 17 & 18 & 19 & 20 & 21 & 22 & 23 & 24 & 25 & 26 & 27 & 28 & 29 & 30 & 31 & 32 & 33 & 34 & 35 & 36 & 37 & 38 & 39 \\
				\hline
				{\bf{End-wheel Score}}    & 1  & 1  & 1  & 2  & 2  & 2  & 2  & 3  & 3  & 4  & 4  & 4  & 5  & 5  & 6  & 6  & 7  & 8  & 8  & 9  & 10 & 10 & 11 & 12 & 13 \\
				\hline
			\end{tabular}}
	\end{center}
	\caption{Conversion chart for scores from $15$ hdB to $39$ hdB}
\end{figure}
\noindent Now we can include pre-message keys with only their left letter in common in our deciban sheets for end-wheel analysis.
\subsection{Scritchmus}
We have developed a lot of theory to score repeat structures and various letter offsets so it is best to recap what we get at the end of this analysis. We have
\begin{itemize}
	\item A list of repeat structures and their scores which we will call a {\bf{catalouge}}. This is just a scored tetra catalogue combined with a scored end-wheel catalogue. An example is as follows\footnote{For sufficiently high odds we just write ``certain'' as it may as well be}
	      \begin{figure}[H]

		      \begin{center}
			      \scalebox{0.8}{
				      \begin{tabular}{llll}
					          & \textbf{Catalogue}                 &                 &            \\
					      \hline
					      (1) & \texttt{ARX} = \texttt{AYR} + 6.5  & Octagram        & Certain    \\
					      (2) & \texttt{NTP} = \texttt{NXU} + 2.15 & Enneagram       & Certain    \\
					      (3) & \texttt{LLK} = \texttt{LAP} + 9.24 & Enneagram       & Certain    \\
					      (4) & \texttt{VRN} = \texttt{VXR} + 0.21 & $16^6/ 95$      & 100 : 1 on \\
					      (5) & \texttt{STK} = \texttt{STN} + 0.7  & $23^{33} / 256$ & 15 : 1 on  \\
					      (6) & \texttt{RWL} = \texttt{RWC} + 0.13 & $14^4 / 100$    & 6 : 1 on   \\
					      (7) & \texttt{BVY} = \texttt{BLT} + 1.6  & $19^5 / 140$    & 5 : 1 on   \\
					      (8) & \texttt{UJA} = \texttt{UMY} + 5.3  & $18^5 / 210$    & 3 : 2 on   \\
					      (9) & \texttt{BAQ} = \texttt{BWS} + 0.17 & $20^7 / 274$    & 50 : 1 on  \\
				      \end{tabular}}
		      \end{center}
		      \caption{Catalogue of repeat structures}
		      \label{fig:catalogue}
	      \end{figure}
	\item A list of deciban sheets for a variety of letters combinations compiled from summed likelihoods of letter offsets gleamed from both end-wheel and middle-wheel comparisons. One such deciban sheet is as follows
	      \begin{figure}[H]
		      \begin{center}
			      \scalebox{0.6}{
				      \begin{tabular}{c|*{13}{c|}c}
					      \cline{2-14}
					                    & -6 & -5            & -4           &
					      -3            & -2 & -1            &              & 1 & 2 & 3 & 4 & 5
					                    & 6  &                                                  \\
					      \cline{2-14}
					      \texttt{T   } & 1  & 2             & 7            &
					      7             & 4  & 3             & \texttt{ H } & 5 & 3 & 1 & 7 & 4
					                    & 7  & \texttt{   T}                                    \\
					      \cline{2-14}
				      \end{tabular}}
		      \end{center}

		      \caption{End-wheel deciban sheet for \texttt{H} and \texttt{T}}
		      \label{fig:deciban_sheet}
	      \end{figure}
\end{itemize}
The process of combining these two pieces of information to recover the middle and end rotors became known as {\bf{scritchmus}}.

\subsubsection{Determining $\sigma_3$}
We are now going to determine the mapping of the third letter in the pre-message key $\sigma_3$. We begin by making a chain of letters whose distances are deduced from the likely candidates from our catalogue~\ref{fig:catalogue}. Repeat (1) indicates that $\sigma_3(\texttt{X}) = \sigma_3(\texttt{R}) + 5$. Let us make an initial assumption that $\sigma_3(\texttt{R}) = \texttt{M}$ then we deduce that $\sigma_3(\texttt{X}) = \texttt{M} + 5 = \texttt{R}$. We can place these in an alphabet as follows
\begin{align*}
	 & \texttt{ABCDEFGHIJKLMNOPQRSTUVWXYZ} \\
	 & \texttt{............R....X........}
\end{align*}
In this way, adding in repeats (2)-(5) we get from our initial hypothesis $\sigma_3(\texttt{R}) = \texttt{M}$
\begin{align*}
	 & \texttt{ABCDEFGHIJKLMNOPQRSTUVWXYZ} \\
	 & \texttt{P......N...UR.K..X........}
\end{align*}
Recall that $\sigma_3$ must be an involution so if $\sigma_3(\texttt{R}) = \texttt{M}$ we must also have $\sigma_3(\texttt{M}) = \texttt{R}$, but of course this contradicts our derivation that $\sigma_3(\texttt{M}) = \texttt{X}$. Then our initial hypothesis $\sigma_3(\texttt{R}) = \texttt{M}$ is likely wrong. We must therefore continue through all hypotheses for the value of $\sigma_3(\texttt{R})$. We can eliminate possibilities as follows
% \begin{align*}
% 	 & \texttt{ABCDEFGHIJKLMNOPQRSTUVWXYZ} &                                                                 \\
% 	 & \texttt{P......N...UR.K..X........} & \text{--- Contradicts reciprocal $\texttt{R}$ and $\texttt{M}$} \\
% 	 & \texttt{.P......N...UR.K..X.......} & \text{--- Contradicts reciprocal $\texttt{P}$ and $\texttt{B}$} \\
% 	 & \texttt{..P......N...UR.K..X......} & \text{--- Contradicts reciprocal $\texttt{N}$ and $\texttt{J}$} \\
% 	 & \texttt{...P......N...UR.K..X.....} & \text{--- Contradicts reciprocal $\texttt{R}$ and $\texttt{M}$} \\
% 	 & \texttt{....P......N...UR.K..X....} & \text{--- Contradicts reciprocal $\texttt{P}$ and $\texttt{E}$} \\
% 	 & \texttt{.....P......N...UR.K..X...} & \text{--- Contradicts $\texttt{R}$ cannot be self-reciprocal}   \\
% 	 & \texttt{......P......N...UR.K..X..} & \text{--- Contradicts $\texttt{N}$ cannot be self-reciprocal}   \\
% 	 & \texttt{.......P......N...UR.K..X.} & \text{--- Possible}                                             \\
% 	 & \texttt{........P......N...UR.K..X} & \text{--- Contradicts reciprocal $\texttt{P}$ and $\texttt{I}$} \\
% 	 & \texttt{X........P......N...UR.K..} & \text{--- Contradicts $\texttt{U}$ cannot be self-reciprocal}   \\
% 	 & \texttt{.X........P......N...UR.K.} & \text{--- Contradicts reciprocal $\texttt{R}$ and $\texttt{M}$} \\
% 	 & \texttt{..X........P......N...UR.K} & \text{--- Contradicts reciprocal $\texttt{X}$ and $\texttt{A}$} \\
% 	 & \texttt{K..X........P......N...UR.} & \text{--- Contradicts reciprocal $\texttt{X}$ and $\texttt{D}$} \\
% 	 & \texttt{.K..X........P......N...UR} & \text{--- Contradicts reciprocal $\texttt{P}$ and $\texttt{N}$} \\
% 	 & \texttt{R.K..X........P......N...U} & \text{--- Possible}                                             \\
% 	 & \texttt{UR.K..X........P......N...} & \text{--- Contradicts $\texttt{P}$ cannot be self-reciprocal}   \\
% 	 & \texttt{.UR.K..X........P......N..} & \text{--- Contradicts reciprocal $\texttt{X}$ and $\texttt{H}$} \\
% 	 & \texttt{..UR.K..X........P......N.} & \text{--- Contradicts reciprocal $\texttt{R}$ and $\texttt{D}$} \\
% 	 & \texttt{...UR.K..X........P......N} & \text{--- Possible}                                             \\
% 	 & \texttt{N...UR.K..X........P......} & \text{--- Contradicts reciprocal $\texttt{K}$ and $\texttt{H}$} \\
% 	 & \texttt{.N...UR.K..X........P.....} & \text{--- Contradicts reciprocal $\texttt{U}$ and $\texttt{F}$} \\
% 	 & \texttt{..N...UR.K..X........P....} & \text{--- Possible}                                             \\
% 	 & \texttt{...N...UR.K..X........P...} & \text{--- Contradicts reciprocal $\texttt{N}$ and $\texttt{D}$} \\
% 	 & \texttt{....N...UR.K..X........P..} & \text{--- Contradicts reciprocal $\texttt{X}$ and $\texttt{O}$} \\
% 	 & \texttt{.....N...UR.K..X........P.} & \text{--- Contradicts reciprocal $\texttt{R}$ and $\texttt{K}$} \\
% 	 & \texttt{......N...UR.K..X........P} & \text{--- Contradicts reciprocal $\texttt{U}$ and $\texttt{K}$} \\
% \end{align*}


\setlength{\tabcolsep}{3pt}
\renewcommand{\arraystretch}{1.1}

\begin{center}
	\scalebox{0.76}{
		\begin{tabular}{|*{26}{c|}l|}
			\hline
			\texttt{A} & \texttt{B} & \texttt{C} & \texttt{D} & \texttt{E} & \texttt{F} & \texttt{G} & \texttt{H} & \texttt{I} & \texttt{J} & \texttt{K} & \texttt{L} & \texttt{M} & \texttt{N} & \texttt{O} & \texttt{P} & \texttt{Q} & \texttt{R} & \texttt{S} & \texttt{T} & \texttt{U} & \texttt{V} & \texttt{W} & \texttt{X} & \texttt{Y} & \texttt{Z} & {\bf{Notes}}                                         \\
			\hline
			\texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{R} and \texttt{M} \\
			\texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{P} and \texttt{B} \\
			\texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{N} and \texttt{J} \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{R} and \texttt{M} \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{P} and \texttt{E} \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts \texttt{R} cannot be self-reciprocal \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \;\;Contradicts \texttt{N} cannot be self-reciprocal \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \;\;{\bf{Possible}}                                  \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \;\;Contradicts reciprocal \texttt{P} and \texttt{I} \\
			\texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \;\;Contradicts \texttt{U} cannot be self-reciprocal \\
			\texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \;\;Contradicts reciprocal \texttt{R} and \texttt{M} \\
			\texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \;\;Contradicts reciprocal \texttt{X} and \texttt{A} \\
			\texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \;\;Contradicts reciprocal \texttt{X} and \texttt{D} \\
			\texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \;\;Contradicts reciprocal \texttt{P} and \texttt{N} \\
			\texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \;\;{\bf{Possible}}                                  \\
			\texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts \texttt{P} cannot be self-reciprocal \\
			\texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{X} and \texttt{H} \\
			\texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \;\;Contradicts reciprocal \texttt{R} and \texttt{D} \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \;\;{\bf{Possible}}                                  \\
			\texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{K} and \texttt{H} \\
			\texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{U} and \texttt{F} \\
			\texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;{\bf{Possible}}                                  \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{N} and \texttt{D} \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \;\;Contradicts reciprocal \texttt{X} and \texttt{O} \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \;\;Contradicts reciprocal \texttt{R} and \texttt{K} \\
			\texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \;\;Contradicts reciprocal \texttt{U} and \texttt{K} \\
			\hline
		\end{tabular}}
\end{center}
\noindent In the end we arrive at only $4$ possible alphabets. By filling in values given by the reciprocal nature of $\sigma_3$ we arrive at these four alphabets.
\setlength{\tabcolsep}{3pt}
\renewcommand{\arraystretch}{1.1}

\begin{center}
	\scalebox{0.76}{
		\begin{tabular}{|l|*{26}{c|}l|}
			\hline
			    & \texttt{A} & \texttt{B} & \texttt{C} & \texttt{D} & \texttt{E} & \texttt{F} & \texttt{G} & \texttt{H} & \texttt{I} & \texttt{J} & \texttt{K} & \texttt{L} & \texttt{M} & \texttt{N} & \texttt{O} & \texttt{P} & \texttt{Q} & \texttt{R} & \texttt{S} & \texttt{T} & \texttt{U} & \texttt{V} & \texttt{W} & \texttt{X} & \texttt{Y} & \texttt{Z} & {\bf{Notes}}                 \\
			\hline

			(a) & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{P} & \texttt{.} & \texttt{.} & \texttt{V} & \texttt{.} & \texttt{.} & \texttt{O} & \texttt{N} & \texttt{H} & \texttt{.} & \texttt{T} & \texttt{U} & \texttt{R} & \texttt{S} & \texttt{K} & \texttt{.} & \texttt{Y} & \texttt{X} & \texttt{.} & \;\;Picks up (7), denies (8) \\
			(b) & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{C} & \texttt{.} & \texttt{.} & \texttt{V} & \texttt{P} & \texttt{O} & \texttt{.} & \texttt{A} & \texttt{.} & \texttt{.} & \texttt{Z} & \texttt{N} & \texttt{.} & \texttt{F} & \texttt{.} & \texttt{U} & \;\;Denies (6)/(8)           \\
			(c) & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{.} & \texttt{.} & \texttt{X} & \texttt{G} & \texttt{.} & \texttt{.} & \texttt{Z} & \texttt{.} & \texttt{S} & \texttt{.} & \texttt{E} & \texttt{P} & \texttt{.} & \texttt{D} & \texttt{.} & \texttt{.} & \texttt{J} & \texttt{.} & \texttt{N} & \;\;Denies (9)               \\
			(d) & \texttt{.} & \texttt{.} & \texttt{N} & \texttt{.} & \texttt{.} & \texttt{.} & \texttt{U} & \texttt{R} & \texttt{.} & \texttt{K} & \texttt{J} & \texttt{.} & \texttt{X} & \texttt{C} & \texttt{.} & \texttt{V} & \texttt{.} & \texttt{H} & \texttt{.} & \texttt{.} & \texttt{G} & \texttt{P} & \texttt{.} & \texttt{M} & \texttt{.} & \texttt{.} &                              \\
			\hline
		\end{tabular}}
\end{center}

\noindent  After filling in the alphabets further, we notice that some alphabets either contradict (deny) or support (pick up) the remaining hypotheses we have not included, that is, hypotheses (6)-(9). As (6) and (9) are both strong hypotheses, this will discount the validity of alphabets (b) and (c). Leaving us with remaining alphabets (a) and (d). Note that the denial of (8) for alphabet (a) is not that strong of an indicator against this alphabet since (8) has roughly even odds of being correct and picking up (7) is such that it outweighs the denial of (8) anyways.
\\\\We now need to determine which of (a) or (d) is correct. To do this we can turn to our deciban sheets~\ref{fig:deciban_sheet}. For example, we note that alphabet (a) is such that $\texttt{T} = \texttt{H} + 2$ which is evidence $3$ hdB in favor of this alphabet. Alexander's example found that after adding up all the offsets in alphabet (a) against deciban sheets, we find that the alphabet has a total score of $54$ hdB, almost certainly indicating that alphabet (a) is our correct choice for $\sigma_3$.
\\\\We can now further fill in the alphabet from hypotheses that got picked up. We begin by including hypothesis (9) and using $\sigma_3$'s reciprocal property to get the alphabet
\begin{align*}
	 & \texttt{ABCDEFGHIJKLMNOPQRSTUVWXYZ} \\
	 & \texttt{.......P..VQ.ONHLTURSK.YX.}
\end{align*}
Now we that we have add \texttt{L} to our alphabet we can make use of hypothesis (6) to get
\begin{align*}
	 & \texttt{ABCDEFGHIJKLMNOPQRSTUVWXYZ} \\
	 & \texttt{..DC...P..VQ.ONHLTURSK.YX.}
\end{align*}
With a large catalogue, we will often be able to fill out the entire alphabet in this way.

\subsubsection{Recovering the End Rotor}
We will now examine what possible end rotors could be used that corroborate our alphabet for $\sigma_3$. Consider that for our end-wheel comparisons like hypothesis (5) and (6), we have strong indication that no turnover occurred during these repeat structures. Therefore we may assume that no turnover occurred between the encipherment of \texttt{C} and \texttt{L}, and no turnover occurred between \texttt{N} and \texttt{K}. Thus we can assume no turnover occurred between \texttt{C} and \texttt{K}. Given that this is a stretch of $18$ letters, we can immediately eliminate the possibility that the rightmost rotor is a naval rotor as it would have turnover at least every $13$ letters. That leaves us with rotors \texttt{I}-\texttt{V}. Rotors \texttt{I}, \texttt{II}, and \texttt{IV}, all have turnover between \texttt{C} and \texttt{K}. Thus we are left with only the possibilities that the rightmost rotor is \texttt{III} or \texttt{V} -- narrowing our possibilities from $8$ to $2$.

\subsubsection{Recovering the Middle Rotor}
Determining the middle rotor is much the same as the above procedure. Our goal is to get a likely alphabet for $\sigma_2$ and determine where turnover of the leftmost wheel occurred so as to eliminate possible middle rotors. The only difference is that we now strongly suspect that turnover of the rightmost rotor occurred between \texttt{K} and \texttt{C}. Thus a hypothesis like (2) which asserts that, in the middle wheel alphabet $\texttt{T} = \texttt{X} + 2$, must be adjusted to state that $\texttt{T} = \texttt{X} + 3$ since we know turnover of the rightmost rotor occurred in passing from \texttt{P} to \texttt{U}. Adjusting our offsets as necessary we can perform the exact same analysis as above to determine a small set of possibilities for the middle rotor.
\\\\All in all, this process can reduce the $276$ rotor orderings of the naval Enigma to only a handful of possibilities, thus making searching for naval settings on the Bombe tractable. However, in order to actually make use of the Bombe we still need a crib to determine invalid settings.

\subsection{Running the Bombe}
By this point we have determined a handful of possible rotor orderings, and we have, with luck, determine the entirety of permutations $\sigma_2$ and $\sigma_3$. Note though, that the permutations $\sigma_2$ and $\sigma_3$ are themselves plaintext-ciphertext pairings! For example, if we determine $\sigma_2$ and $\sigma_3$ to be
\begin{align*}
	             & \texttt{ABCDEFGHIJKLMNOPQRSTUVWXYZ} \\
	\sigma_2\;\; & \texttt{KJNRPQUOLBAISCHEFDMYGZXWTV} \\
	\sigma_3\;\; & \texttt{OVJWLSKMUCGEHTAXRQFNIBDPZY} \\
\end{align*}
Then we get a series of $2$ letter plaintext-ciphertext pairings, such as

\begin{center}
	\begin{tikzpicture}[node distance=1cm, every node/.style={draw,
					circle, minimum height=0.1cm, minimum width=0.1cm}]

		% Centering the diagram
		\node (a1) [] {\texttt{?}};
		\node (a2) [right=0.1cm of a1] {\texttt{A}};
		\node (a3) [right=0.1cm of a2] {\texttt{B}};
		% Nodes for ciphertext
		\node (x1) [below=1cm of a1] {\texttt{?}};
		\node (x2) [below=1cm of a2] {\texttt{K}};
		\node (x3) [below=1cm of a3] {\texttt{O}};

		% Arrows for mapping
		\draw[->] (a1) -- (x1) node[midway, left, draw=none, fill=none] {1};
		\draw[->] (a2) -- (x2) node[midway, left, draw=none, fill=none] {2};
		\draw[->] (a3) -- (x3) node[midway, left, draw=none, fill=none] {3};

	\end{tikzpicture}
\end{center}
Using these plaintext-ciphertext mappings we can construct a menu as follows
\begin{figure}[H]
	\begin{center}
		\scalebox{0.8}{
			\begin{tikzpicture}[>=stealth, every node/.style={}]
				% Manual node positions

				\node (H) at (0,0) {\texttt{H}};
				\node (O) at (1.5,0) {\texttt{O}};
				\node (A) at (3,0) {\texttt{A}};
				\node (K) at (4.5,0) {\texttt{K}};
				\node (G) at (6,0) {\texttt{G}};
				\node (U) at (7.5,0) {\texttt{U}};
				\node (I) at (9,0) {\texttt{I}};
				\node (L) at (10.5,0) {\texttt{L}};
				\node (E) at (12,0) {\texttt{E}};
				\node (M) at (0,-2) {\texttt{M}};
				\node (S) at (1.5,-2) {\texttt{S}};
				\node (F) at (3,-2) {\texttt{F}};
				\node (Q) at (4.5,-2) {\texttt{Q}};
				\node (R) at (6,-2) {\texttt{R}};
				\node (D) at (7.5,-2) {\texttt{D}};
				\node (W) at (9,-2) {\texttt{W}};
				\node (X) at (10.5,-2) {\texttt{X}};
				\node (P) at (12,-2) {\texttt{P}};
				\node (C) at (3.75,-3.5) {\texttt{C}};
				\node (N) at (5.25,-3.5) {\texttt{N}};
				\node (T) at (6.75,-3.5) {\texttt{T}};
				\node (Y) at (8.25,-3.5) {\texttt{Y}};
				\node (J) at (3.75,-5.5) {\texttt{J}};
				\node (B) at (5.25,-5.5) {\texttt{B}};
				\node (V) at (6.75,-5.5) {\texttt{V}};
				\node (Z) at (8.25,-5.5) {\texttt{Z}};



				% Connections
				\draw[-] (K) -- (A) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (O) -- (H) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (M) -- (S) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (Q) -- (F) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (R) -- (D) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (W) -- (X) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (P) -- (E) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (L) -- (I) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (U) -- (G) node[midway, above, sloped] {\texttt{ZZB}};
				\draw[-] (C) -- (N) node[midway, above, sloped] {\texttt{ZZB}};

				\draw[-] (T) -- (Y) node[midway, above, sloped] {\texttt{ZZB}};

				\draw[-] (Z) -- (V) node[midway, above, sloped] {\texttt{ZZB}};

				\draw[-] (B) -- (J) node[midway, above, sloped] {\texttt{ZZB}};


				\draw[-] (O) -- (A) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (K) -- (G) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (U) -- (I) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (L) -- (E) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (X) -- (P) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (D) -- (W) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (Q) -- (R) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (S) -- (F) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (M) -- (H) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (N) -- (T) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (Z) -- (Y) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (B) -- (V) node[midway, above, sloped] {\texttt{ZZC}};
				\draw[-] (J) -- (C) node[midway, above, sloped] {\texttt{ZZC}};
			\end{tikzpicture}}
	\end{center}
	\caption{Menu constructed from Banburismus}
\end{figure}
\noindent Equipped with this menu, the Bombe can now be run for our limited set of rotor orderings and can deduce the steckerings and positions of rotors necessary to produce our menu -- that is, the settings which convert pre-message keys into message keys.
\subsubsection{The \texttt{EINS} Catalogue}
Recall from section~\ref{bombe_ring_setting} that the settings given by a stop of the Bombe do not necessarily correspond to the true ring settings. In order to determine the true ring settings we would normally use our plaintext-ciphertext pairing to determine at which point turnover occurred and adjust our ring setting as necessary. However, our cribs consist exclusively of two letter plaintext-ciphertext pairings, after which the message is enciphered with the message key and is thus meaningless. Therefore we can no longer deduce at what point during our message turnover occurs and thus can no longer use this method to determine the true ring setting.
\\\\In analyzing naval Enigma traffic, cryptanalysts found that nearly all messages (around $90\%$) contained the word \texttt{EINS} (German for ``one'') at some point in the message. This makes sense for a number of reasons
\begin{enumerate}
	\item Naval messages regularly dealt with numbers, all of which needed to be typed out in full. This statistical observation is what made the use of the tetra catalogue so valuable.
	\item An odd quirk known as {\bf{Benford's law}} tells us that $1$ appears more commonly than any other leading digit in numerical data.
	\item \texttt{EINS} shows up naturally in many German words either as a sub-component of a word or when spanning across two words.
	      % https://web.archive.org/web/20160309155544/http://stoneship.org.uk/~steve/banburismus.html %
\end{enumerate}

% \end{enumerate}
\noindent Given that we have a known rotor ordering, steckering, and ring/window setting whose relative distance is correct but may need to be adjusted to get the true ring setting, we can compiled a list of all $26^3$ encipherments of \texttt{EINS} which preserve the relative distance between our ring and window setting. Originally this process had to be done by hand with catalogues known as {\bf{corsets}} but a machine called the {\bf{test-plate}} or {\bf{baby}} was created which automatically enciphered \texttt{EINS} at all such positions into an {\bf{\texttt{EINS} catalogue}}.
\\\\The catalogue could be used to determine locations within our message corpus, along with settings, that would produce \texttt{EINS}. If we then continue deciphering our message from the start of the \texttt{EINS} location,using these settings, we either find likely plaintext or gibberish. This gives a candidate for the rightmost ring setting. Then as in section~\ref{bombe_ring_setting} we continue attempting to decipher plaintext until we encounter gibberish and adjust the middle and subsequently left ring setting until we have deduced the entire ring setting. With this final component we are now able to completely decipher naval Enigma messages.
\\\\It is clear from the amount of messages, sheets, and scores that need to be compared and tabulated that Banburismus was a great deal of work. Alexander estimates that an average day involved 400 messages with an average length of 150 characters. In total around 6000 comparisons needed to be made all of which needed to be scored and counted. Particular credit should be given to whom Alexander noted was ``one of the best Banburists'', Joan Clarke. Not only was she an exceptional banburist, she was one of only a handful of female cryptologists working at Bletchley Park.
\\\\The work done by Banburists provided crucial information on Naval operations including U-Boat attacks which were crippling supply lines and starving Britain.
% THE BABY THE RACK
% http://www.ellsbury.com/profsbk/profsbk-140.htm% 
% FORTYWEEPYYWEEPY http://www.ellsbury.com/hut8/hut8-013.htm%
%https://en.wikipedia.org/wiki/Cryptanalysis_of_the_Enigma% 


%Gardening, Parkerismus, Consecutive Stecker knockour %
%chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://www.singingbanana.com/enigmaproject/maths.pdf%
